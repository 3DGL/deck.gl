/*! For license information please see component---src-examples-tile-3-d-layer-js-f25736f0537b231011c2.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{"+TUu":function(t,e,n){var r;!function(i,a,o,s){"use strict";var c,u=["","webkit","Moz","MS","ms","o"],l=a.createElement("div"),h=Math.round,p=Math.abs,f=Date.now;function d(t,e,n){return setTimeout(O(t,n),e)}function v(t,e,n){return!!Array.isArray(t)&&(y(t,n[e],n),!0)}function y(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function b(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=i.console&&(i.console.warn||i.console.log);return a&&a.call(i.console,r,n),t.apply(this,arguments)}}c="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var g=b((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),m=b((function(t,e){return g(t,e,!0)}),"merge","Use `assign`.");function _(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&c(r,n)}function O(t,e){return function(){return t.apply(e,arguments)}}function j(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function w(t,e){return void 0===t?e:t}function E(t,e,n){y(P(e),(function(e){t.addEventListener(e,n,!1)}))}function T(t,e,n){y(P(e),(function(e){t.removeEventListener(e,n,!1)}))}function k(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function x(t,e){return t.indexOf(e)>-1}function P(t){return t.trim().split(/\s+/g)}function S(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function A(t){return Array.prototype.slice.call(t,0)}function I(t,e,n){for(var r=[],i=[],a=0;a<t.length;){var o=e?t[a][e]:t[a];S(i,o)<0&&r.push(t[a]),i[a]=o,a++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function C(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),a=0;a<u.length;){if((r=(n=u[a])?n+i:e)in t)return r;a++}}var R=1;function D(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var L="ontouchstart"in i,N=void 0!==C(i,"PointerEvent"),M=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z=["x","y"],U=["clientX","clientY"];function B(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){j(t.options.enable,[t])&&n.handler(e)},this.init()}function F(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,a=1&e&&r-i==0,o=12&e&&r-i==0;n.isFirst=!!a,n.isFinal=!!o,a&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=V(e));i>1&&!n.firstMultiple?n.firstMultiple=V(e):1===i&&(n.firstMultiple=!1);var a=n.firstInput,o=n.firstMultiple,s=o?o.center:a.center,c=e.center=G(r);e.timeStamp=f(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=W(s,c),e.distance=Z(s,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},a=t.prevInput||{};1!==e.eventType&&4!==a.eventType||(i=t.prevDelta={x:a.deltaX||0,y:a.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var u=H(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=p(u.x)>p(u.y)?u.x:u.y,e.scale=o?(l=o.pointers,h=r,Z(h[0],h[1],U)/Z(l[0],l[1],U)):1,e.rotation=o?function(t,e){return W(e[1],e[0],U)+W(t[1],t[0],U)}(o.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,a,o=t.lastInterval||e,s=e.timeStamp-o.timeStamp;if(8!=e.eventType&&(s>25||void 0===o.velocity)){var c=e.deltaX-o.deltaX,u=e.deltaY-o.deltaY,l=H(s,c,u);r=l.x,i=l.y,n=p(l.x)>p(l.y)?l.x:l.y,a=q(c,u),t.lastInterval=e}else n=o.velocity,r=o.velocityX,i=o.velocityY,a=o.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=a}(n,e);var l,h;var d=t.element;k(e.srcEvent.target,d)&&(d=e.srcEvent.target);e.target=d}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function V(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:G(e),deltaX:t.deltaX,deltaY:t.deltaY}}function G(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function H(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:p(t)>=p(e)?t<0?2:4:e<0?8:16}function Z(t,e,n){n||(n=z);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function W(t,e,n){n||(n=z);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}B.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(D(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(D(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4};function X(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,B.apply(this,arguments)}_(X,B,{handler:function(t){var e=Y[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var J={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},K={2:"touch",3:"pen",4:"mouse",5:"kinect"},Q="pointerdown",$="pointermove pointerup pointercancel";function tt(){this.evEl=Q,this.evWin=$,B.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(Q="MSPointerDown",$="MSPointerMove MSPointerUp MSPointerCancel"),_(tt,B,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=J[r],a=K[t.pointerType]||t.pointerType,o="touch"==a,s=S(e,t.pointerId,"pointerId");1&i&&(0===t.button||o)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:a,srcEvent:t}),n&&e.splice(s,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function nt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,B.apply(this,arguments)}function rt(t,e){var n=A(t.touches),r=A(t.changedTouches);return 12&e&&(n=I(n.concat(r),"identifier",!0)),[n,r]}_(nt,B,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=rt.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function at(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},B.apply(this,arguments)}function ot(t,e){var n=A(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,a,o=A(t.changedTouches),s=[],c=this.target;if(a=n.filter((function(t){return k(t.target,c)})),1===e)for(i=0;i<a.length;)r[a[i].identifier]=!0,i++;for(i=0;i<o.length;)r[o[i].identifier]&&s.push(o[i]),12&e&&delete r[o[i].identifier],i++;return s.length?[I(a.concat(s),"identifier",!0),s]:void 0}_(at,B,{handler:function(t){var e=it[t.type],n=ot.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});function st(){B.apply(this,arguments);var t=O(this.handler,this);this.touch=new at(this.manager,t),this.mouse=new X(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ct(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ut.call(this,e)):12&t&&ut.call(this,e)}function ut(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function lt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],a=Math.abs(e-i.x),o=Math.abs(n-i.y);if(a<=25&&o<=25)return!0}return!1}_(st,B,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ct.call(this,e,n);else if(i&&lt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ht=C(l.style,"touchAction"),pt=void 0!==ht,ft=function(){if(!pt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function dt(t,e){this.manager=t,this.set(e)}dt.prototype={set:function(t){"compute"==t&&(t=this.compute()),pt&&this.manager.element.style&&ft[t]&&(this.manager.element.style[ht]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return y(this.manager.recognizers,(function(e){j(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(x(t,"none"))return"none";var e=x(t,"pan-x"),n=x(t,"pan-y");if(e&&n)return"none";if(e||n)return e?"pan-x":"pan-y";if(x(t,"manipulation"))return"manipulation";return"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=x(r,"none")&&!ft.none,a=x(r,"pan-y")&&!ft["pan-y"],o=x(r,"pan-x")&&!ft["pan-x"];if(i){var s=1===t.pointers.length,c=t.distance<2,u=t.deltaTime<250;if(s&&c&&u)return}if(!o||!a)return i||a&&6&n||o&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function vt(t){this.options=c({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function yt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function bt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function gt(t,e){var n=e.manager;return n?n.get(t):t}function mt(){vt.apply(this,arguments)}function _t(){mt.apply(this,arguments),this.pX=null,this.pY=null}function Ot(){mt.apply(this,arguments)}function jt(){vt.apply(this,arguments),this._timer=null,this._input=null}function wt(){mt.apply(this,arguments)}function Et(){mt.apply(this,arguments)}function Tt(){vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function kt(t,e){return(e=e||{}).recognizers=w(e.recognizers,kt.defaults.preset),new xt(t,e)}vt.prototype={defaults:{},set:function(t){return c(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(v(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=gt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return v(t,"dropRecognizeWith",this)||(t=gt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(v(t,"requireFailure",this))return this;var e=this.requireFail;return-1===S(e,t=gt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(v(t,"dropRequireFailure",this))return this;t=gt(t,this);var e=S(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+yt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+yt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=c({},t);if(!j(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},_(mt,vt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),_(_t,mt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,a=t.deltaX,o=t.deltaY;return i&e.direction||(6&e.direction?(i=0===a?1:a<0?2:4,n=a!=this.pX,r=Math.abs(t.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return mt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=bt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),_(Ot,mt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),_(jt,vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),_(wt,mt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),_(Et,mt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return _t.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&p(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=bt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),_(Tt,vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,o=!this.pCenter||Z(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,o&&a?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=d((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),kt.VERSION="2.0.7",kt.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[wt,{enable:!1}],[Ot,{enable:!1},["rotate"]],[Et,{direction:6}],[_t,{direction:6},["swipe"]],[Tt],[Tt,{event:"doubletap",taps:2},["tap"]],[jt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function xt(t,e){var n;this.options=c({},kt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(N?tt:M?at:L?st:X))(n,F),this.touchAction=new dt(this,this.options.touchAction),Pt(this,!0),y(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Pt(t,e){var n,r=t.element;r.style&&(y(t.options.cssProps,(function(i,a){n=C(r.style,a),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}xt.prototype={set:function(t){return c(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var a=0;a<r.length;)n=r[a],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),a++}},get:function(t){if(t instanceof vt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(v(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(v(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=S(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return y(P(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return y(P(t),(function(t){e?n[t]&&n[t].splice(S(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=a.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Pt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(kt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:xt,Input:B,TouchAction:dt,TouchInput:at,MouseInput:X,PointerEventInput:tt,TouchMouseInput:st,SingleTouchInput:nt,Recognizer:vt,AttrRecognizer:mt,Tap:Tt,Pan:_t,Swipe:Et,Pinch:Ot,Rotate:wt,Press:jt,on:E,off:T,each:y,merge:m,extend:g,assign:c,inherit:_,bindFn:O,prefixed:C}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=kt,void 0===(r=function(){return kt}.call(e,n,e,t))||(t.exports=r)}(window,document)},"5zO3":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return p}));var r=n("1OyB"),i=n("vuIU"),a=n("rePB"),o=n("BHO1"),s=n.n(o),c=n("oJR1");var u={container:s.a.object,gl:s.a.object,mapboxApiAccessToken:s.a.string,mapboxApiUrl:s.a.string,attributionControl:s.a.bool,preserveDrawingBuffer:s.a.bool,reuseMaps:s.a.bool,transformRequest:s.a.func,mapOptions:s.a.object,mapStyle:s.a.oneOfType([s.a.string,s.a.object]),visible:s.a.bool,asyncRender:s.a.bool,onLoad:s.a.func,onError:s.a.func,width:s.a.number,height:s.a.number,viewState:s.a.object,longitude:s.a.number,latitude:s.a.number,zoom:s.a.number,bearing:s.a.number,pitch:s.a.number,altitude:s.a.number},l={container:c.a.body,mapboxApiAccessToken:function(){var e=null;if("undefined"!=typeof window&&window.location){var n=window.location.search.match(/access_token=([^&\/]*)/);e=n&&n[1]}e||void 0===t||(e=e||"pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg");return e||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&s.a.checkPropTypes(u,t,"prop",e)}var p=function(){function t(e){var n=this;if(Object(r.a)(this,t),Object(a.a)(this,"mapboxgl",void 0),Object(a.a)(this,"props",l),Object(a.a)(this,"_map",null),Object(a.a)(this,"width",0),Object(a.a)(this,"height",0),Object(a.a)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return Object(i.a)(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"resize",value:function(){return this._map.resize(),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(e.mapStyle,{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var r={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:e.mapStyle,interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(r.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,e.mapOptions)),this._map.once("load",e.onLoad),this._map.on("error",e.onError)}return this}},{key:"_destroy",value:function(){this._map&&(t.savedMap?this._map.remove():(t.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(t){var e=this;h(t=Object.assign({},l,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||l.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){h(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),r=this._updateMapSize(t,e);e.asyncRender||!n&&!r||this.redraw(),this.props=e}}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,a=e.pitch,o=void 0===a?0:a,s=e.bearing,c=void 0===s?0:s,u=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:o,bearing:c,altitude:void 0===u?1.5:u}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if(void 0!==c.a)try{var e=c.a.createElement("div");e.className="mapboxgl-map",e.style.display="none",c.a.body.appendChild(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var r=c.a.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),c.a.head.appendChild(r)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();Object(a.a)(p,"initialized",!1),Object(a.a)(p,"propTypes",u),Object(a.a)(p,"defaultProps",l),Object(a.a)(p,"savedMap",null)}).call(this,n("8oxB"))},"9Nty":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"decode",(function(){return ki})),n.d(r,"encode",(function(){return Pi}));var i={};n.r(i),n.d(i,"decode",(function(){return Ni})),n.d(i,"encode",(function(){return Mi}));var a={};n.r(a),n.d(a,"decode",(function(){return Bi})),n.d(a,"encode",(function(){return Fi}));var o={};n.r(o),n.d(o,"decode",(function(){return Hi})),n.d(o,"encode",(function(){return qi}));var s=n("dI71"),c=n("q1tI"),u=n.n(c),l=n("lxDd"),h=n("rePB"),p=(n("i8i4"),n("wx14")),f=n("1OyB"),d=n("JX7q"),v=n("vuIU"),y=n("Ji7U"),b=n("md7G"),g=n("foSv"),m=n("BHO1"),_=n.n(m);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var T=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function k(t){if(!t)return null;if("string"==typeof t)return t;t.toJS&&(t=t.toJS());var e,n={},r=w(t.layers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.id]=i}}catch(o){r.e(o)}finally{r.f()}var a=t.layers.map((function(t){var e=n[t.ref],r=null;if("interactive"in t&&delete(r=j({},t)).interactive,e){delete(r=r||j({},t)).ref;var i,a=w(T);try{for(a.s();!(i=a.n()).done;){var s=i.value;s in e&&(r[s]=e[s])}}catch(o){a.e(o)}finally{a.f()}}return r||t}));return j(j({},t),{},{layers:a})}var x=n("R25c"),P=n("evtk"),S=n("5zO3"),A=n("kZXF"),I=n.n(A),C=n("ODXe");function R(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function D(t,e){if(t===e)return!0;if(R(t)&&R(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!D(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=1e-7}function L(t,e,n){return Math.max(e,Math.min(n,t))}function N(t,e,n){return R(t)?t.map((function(t,r){return N(t,e[r],n)})):n*e+(1-n)*t}function M(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function z(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return U(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var B=function(){function t(){Object(f.a)(this,t),Object(h.a)(this,"propNames",[])}return Object(v.a)(t,[{key:"arePropsEqual",value:function(t,e){var n,r=z(this.propNames||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!D(t[i],e[i]))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){M(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}(),F={longitude:1,bearing:1};function V(t){return Number.isFinite(t)||Array.isArray(t)}function G(t,e,n){return function(t){return t in F}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}function H(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var W=["longitude","latitude","zoom","bearing","pitch"],Y=["latitude","longitude","zoom","width","height"],X=["bearing","pitch"],J={speed:1.2,curve:1.414};!function(t){Object(y.a)(n,t);var e=Z(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(f.a)(this,n),t=e.call(this),Object(h.a)(Object(d.a)(t),"speed",void 0),Object(h.a)(Object(d.a)(t),"propNames",W),Object(h.a)(Object(d.a)(t),"props",void 0),t.props=Object.assign({},J,r),t}Object(v.a)(n,[{key:"initializeProps",value:function(t,e){var n,r={},i={},a=H(Y);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=t[o],c=e[o];M(V(s)&&V(c),"".concat(o," must be supplied for transition")),r[o]=s,i[o]=G(o,s,c)}}catch(d){a.e(d)}finally{a.f()}var u,l=H(X);try{for(l.s();!(u=l.n()).done;){var h=u.value,p=t[h]||0,f=e[h]||0;r[h]=p,i[h]=G(h,p,f)}}catch(d){l.e(d)}finally{l.f()}return{start:r,end:i}}},{key:"interpolateProps",value:function(t,e,n){var r,i=Object(x.d)(t,e,n,this.props),a=H(X);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=N(t[o],e[o],n)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=Object(x.g)(t,e,this.props)),n}}])}(B);function K(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var tt=["longitude","latitude","zoom","bearing","pitch"],et=function(t){Object(y.a)(n,t);var e=$(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(f.a)(this,n),t=e.call(this),Object(h.a)(Object(d.a)(t),"around",void 0),Array.isArray(r)&&(r={transitionProps:r}),t.propNames=r.transitionProps||tt,r.around&&(t.around=r.around),t}return Object(v.a)(n,[{key:"initializeProps",value:function(t,e){var n={},r={};if(this.around){n.around=this.around;var i=new x.a(t).unproject(this.around);Object.assign(r,e,{around:new x.a(e).project(i),aroundLngLat:i})}var a,o=K(this.propNames);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=t[s],u=e[s];M(V(c)&&V(u),"".concat(s," must be supplied for transition")),n[s]=c,r[s]=G(s,c,u)}}catch(l){o.e(l)}finally{o.f()}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r,i={},a=K(this.propNames);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=N(t[o],e[o],n)}}catch(h){a.e(h)}finally{a.f()}if(e.around){var s=new x.a(Object.assign({},e,i)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:N(t.around,e.around,n)}),c=Object(C.a)(s,2),u=c[0],l=c[1];i.longitude=u,i.latitude=l}return i}}]),n}(B),nt={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},rt=0,it=0,at=1.5,ot=function(){function t(e){var n=e.width,r=e.height,i=e.latitude,a=e.longitude,o=e.zoom,s=e.bearing,c=void 0===s?it:s,u=e.pitch,l=void 0===u?rt:u,p=e.altitude,d=void 0===p?at:p,v=e.maxZoom,y=void 0===v?nt.maxZoom:v,b=e.minZoom,g=void 0===b?nt.minZoom:b,m=e.maxPitch,_=void 0===m?nt.maxPitch:m,O=e.minPitch,j=void 0===O?nt.minPitch:O,w=e.transitionDuration,E=e.transitionEasing,T=e.transitionInterpolator,k=e.transitionInterruption,x=e.startPanLngLat,P=e.startZoomLngLat,S=e.startBearing,A=e.startPitch,I=e.startZoom;Object(f.a)(this,t),Object(h.a)(this,"_viewportProps",void 0),Object(h.a)(this,"_interactiveState",void 0),M(Number.isFinite(n),"`width` must be supplied"),M(Number.isFinite(r),"`height` must be supplied"),M(Number.isFinite(a),"`longitude` must be supplied"),M(Number.isFinite(i),"`latitude` must be supplied"),M(Number.isFinite(o),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:i,longitude:a,zoom:o,bearing:c,pitch:l,altitude:d,maxZoom:y,minZoom:g,maxPitch:_,minPitch:j,transitionDuration:w,transitionEasing:E,transitionInterpolator:T,transitionInterruption:k}),this._interactiveState={startPanLngLat:x,startZoomLngLat:P,startBearing:S,startPitch:A,startZoom:I}}return Object(v.a)(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=this._calculateNewLngLat({startPanLngLat:r,pos:e}),a=Object(C.a)(i,2),o=a[0],s=a[1];return this._getUpdatedMapState({longitude:o,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedMapState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,a=this._interactiveState,o=a.startBearing,s=a.startPitch;if(!Number.isFinite(o)||!Number.isFinite(s))return this;var c=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:o||0,startPitch:s||0}),u=c.pitch,l=c.bearing;return this._getUpdatedMapState({bearing:l,pitch:u})}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;M(r>0,"`scale` must be a positive number");var i=this._interactiveState,a=i.startZoom,o=i.startZoomLngLat;Number.isFinite(a)||(a=this._viewportProps.zoom,o=this._unproject(n)||this._unproject(e)),M(o,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:a||0}),c=new x.a(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:o,pos:e}),u=Object(C.a)(c,2),l=u[0],h=u[1];return this._getUpdatedMapState({zoom:s,longitude:l,latitude:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=L(r,n,e);var i=t.maxPitch,a=t.minPitch,o=t.pitch;return t.pitch=L(o,a,i),Object.assign(t,Object(x.l)(t)),t}},{key:"_unproject",value:function(t){var e=new x.a(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new x.a(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,a=r.minZoom;return L(n+Math.log2(e),a,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=L(n,-1,1);var a=this._viewportProps,o=a.minPitch,s=a.maxPitch,c=i;return n>0?c=i+n*(s-i):n<0&&(c=i-n*(o-i)),{pitch:c,bearing:r+180*e}}}]),t}();function st(t){return t[0].toLowerCase()+t.slice(1)}var ct=Object(c.createContext)({viewport:null,map:null,mapContainer:null,onViewportChange:null,onViewStateChange:null,eventManager:null,isDragging:!1});function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var pt="A valid API access token is required to use Mapbox data";var ft={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},dt=Object.assign({},S.a.propTypes,{width:_.a.oneOfType([_.a.number,_.a.string]),height:_.a.oneOfType([_.a.number,_.a.string]),onResize:_.a.func,preventStyleDiffing:_.a.bool,disableTokenWarning:_.a.bool,visible:_.a.bool,className:_.a.string,style:_.a.object,visibilityConstraints:_.a.object}),vt=Object.assign({},S.a.defaultProps,{preventStyleDiffing:!1,disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:nt}),yt=function(t){Object(y.a)(n,t);var e=ht(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"state",{accessTokenInvalid:!1}),Object(h.a)(Object(d.a)(t),"_mapbox",null),Object(h.a)(Object(d.a)(t),"_map",null),Object(h.a)(Object(d.a)(t),"_mapboxMapRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(t),"_mapContainerRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(t),"_queryParams",{}),Object(h.a)(Object(d.a)(t),"_width",0),Object(h.a)(Object(d.a)(t),"_height",0),Object(h.a)(Object(d.a)(t),"getMap",(function(){return t._map})),Object(h.a)(Object(d.a)(t),"queryRenderedFeatures",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t._map.queryRenderedFeatures(e,n)})),Object(h.a)(Object(d.a)(t),"_mapboxMapError",(function(e){401!==(e.error&&e.error.status||e.status)||t.state.accessTokenInvalid||(console.error(pt),t.setState({accessTokenInvalid:!0})),t.props.onError(e)})),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){if(n.supported()){var t=this.props.mapStyle;this._mapbox=new S.a(Object.assign({},this.props,{mapboxgl:I.a,width:this._width,height:this._height,container:this._mapboxMapRef.current,onError:this._mapboxMapError,mapStyle:k(t)})),this._map=this._mapbox.getMap()}}},{key:"componentDidUpdate",value:function(t){this._mapbox&&(this._updateMapStyle(t,this.props),this._updateMapProps(this.props))}},{key:"componentWillUnmount",value:function(){this._mapbox&&(this._mapbox.finalize(),this._mapbox=null,this._map=null)}},{key:"_updateMapSize",value:function(t,e){this._width===t&&this._height===e||(this._width=t,this._height=e,this._updateMapProps(this.props))}},{key:"_updateMapStyle",value:function(t,e){var n=e.mapStyle;n!==t.mapStyle&&n&&this._map.setStyle(k(n),{diff:!this.props.preventStyleDiffing})}},{key:"_updateMapProps",value:function(t){this._mapbox&&this._mapbox.setProps(Object.assign({},t,{width:this._width,height:this._height}))}},{key:"_renderNoTokenWarning",value:function(){if(this.state.accessTokenInvalid&&!this.props.disableTokenWarning){return c.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},c.createElement("h3",{key:"header"},"NO_TOKEN_WARNING"),c.createElement("div",{key:"text"},"For information on setting up your basemap, read"),c.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}return null}},{key:"_renderOverlays",value:function(t){var e=this,n=t.width,r=t.height;return this._updateMapSize(n,r),c.createElement(ct.Consumer,null,(function(t){var i=lt(lt({},t),{},{viewport:new x.a(lt(lt(lt({},e.props),e.props.viewState),{},{width:n,height:r})),map:e._map,mapContainer:t.mapContainer||e._mapContainerRef.current});return c.createElement(ct.Provider,{value:i},c.createElement("div",{key:"map-overlays",className:"overlays",style:ft},e.props.children))}))}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.width,r=t.height,i=t.style,a=t.visibilityConstraints,o=Object.assign({position:"relative"},i,{width:n,height:r}),s=this.props.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt;for(var n in e){var r=n.slice(0,3),i=st(n.slice(3));if("min"===r&&t[i]<e[n])return!1;if("max"===r&&t[i]>e[n])return!1}return!0}(this.props.viewState||this.props,a),u=Object.assign({},ft,{visibility:s?"inherit":"hidden"});return c.createElement("div",{key:"map-container",style:o,ref:this._mapContainerRef},c.createElement("div",{key:"map-mapbox",ref:this._mapboxMapRef,style:u,className:e}),c.createElement(P.a,{key:"autosizer",onResize:this.props.onResize},this._renderOverlays.bind(this)),this._renderNoTokenWarning())}}],[{key:"supported",value:function(){return I.a&&I.a.supported()}}]),n}(c.PureComponent);Object(h.a)(yt,"propTypes",dt),Object(h.a)(yt,"defaultProps",vt);var bt=function(){};var gt=1,mt=2,_t=3,Ot=4,jt={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new et,transitionInterruption:gt,onTransitionStart:bt,onTransitionInterrupt:bt,onTransitionEnd:bt,onViewportChange:bt,onStateChange:bt},wt=function(){function t(e,n){var r=this;Object(f.a)(this,t),Object(h.a)(this,"props",void 0),Object(h.a)(this,"state",void 0),Object(h.a)(this,"time",void 0),Object(h.a)(this,"_animationFrame",null),Object(h.a)(this,"_onTransitionFrame",(function(){r._animationFrame=requestAnimationFrame(r._onTransitionFrame),r._updateViewport()})),e&&(this.props=e),this.time=n||Date.now}return Object(v.a)(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),r=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===mt?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===Ot)){var i=this.time(),a=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}(this.state.easing,a),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===_t||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){M(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator,r=n.getDuration?n.getDuration(t,e):e.transitionDuration;if(0!==r){var i=e.transitionInterpolator.initializeProps(t,e),a={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:r,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{},interactionState:a},this._onTransitionFrame(),this.props.onStateChange(a)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.props.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,n=e.startTime,r=e.duration,i=e.easing,a=e.interpolator,o=e.startProps,s=e.endProps,c=!1,u=(t-n)/r;u>=1&&(u=1,c=!0),u=i(u);var l=a.interpolateProps(o,s,u),h=new ot(Object.assign({},this.props,l));this.state.propsInTransition=h.getViewportProps(),this.props.onViewportChange(this.state.propsInTransition,this.state.interactionState,this.props),c&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();Object(h.a)(wt,"defaultProps",jt);var Et,Tt,kt=n("+TUu"),xt=n.n(kt),Pt={mousedown:1,mousemove:2,mouseup:4};Et=xt.a.PointerEventInput,Tt=Et.prototype.handler,Et.prototype.handler=function(t){var e=this.store;t.button>0&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(e,(function(e){return e.pointerId===t.pointerId}))||e.push(t)),Tt.call(this,t)},xt.a.MouseInput.prototype.handler=function(t){var e=Pt[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};var St=xt.a.Manager,At=xt.a,It=At?[[At.Rotate,{enable:!1}],[At.Pinch,{enable:!1}],[At.Swipe,{enable:!1}],[At.Pan,{threshold:0,enable:!1}],[At.Press,{enable:!1}],[At.Tap,{event:"doubletap",taps:2,enable:!1}],[At.Tap,{event:"anytap",enable:!1}],[At.Tap,{enable:!1}]]:null,Ct={rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Rt={doubletap:["tap"]},Dt={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Lt=["keydown","keyup"],Nt=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],Mt=["wheel","mousewheel","DOMMouseScroll"],zt={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Ut={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Bt=n("q8n8"),Ft=-1!==Bt.b.indexOf("firefox"),Vt=Mt,Gt=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(f.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.events=Vt.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent,!!Bt.a&&{passive:!1})}))}return Object(v.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){if(this.options.enable){var e=t.deltaY;Bt.c.WheelEvent&&(Ft&&t.deltaMode===Bt.c.WheelEvent.DOM_DELTA_PIXEL&&(e/=Bt.c.devicePixelRatio),t.deltaMode===Bt.c.WheelEvent.DOM_DELTA_LINE&&(e*=40));var n={x:t.clientX,y:t.clientY};0!==e&&e%4.000244140625==0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}}},{key:"_onWheel",value:function(t,e,n){this.callback({type:"wheel",center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),Ht=Nt,qt=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(f.a)(this,t),this.element=e,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Ht.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent)}))}return Object(v.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerover"===t&&(this.enableOverEvent=e),"pointerout"===t&&(this.enableOutEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleEvent",value:function(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}},{key:"handleOverEvent",value:function(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:"pointerover",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleOutEvent",value:function(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:"pointerout",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleLeaveEvent",value:function(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:"pointerleave",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleMoveEvent",value:function(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}]),t}(),Zt=Lt,Wt=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(f.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Zt.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent)}))}return Object(v.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}},{key:"handleEvent",value:function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))}}]),t}(),Yt=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(f.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}return Object(v.a)(t,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(t,e){"contextmenu"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){this.options.enable&&this.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),Xt=n("U8pU"),Jt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};var Kt={srcElement:"root",priority:0},Qt=function(){function t(e){Object(f.a)(this,t),this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}return Object(v.a)(t,[{key:"isEmpty",value:function(){return!this._active}},{key:"add",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.handlers,o=this.handlersByElement;n&&("object"!==Object(Xt.a)(n)||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},Kt,n):Kt;var s=o.get(n.srcElement);s||(s=[],o.set(n.srcElement,s));var c={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(c.once=!0),i&&(c.passive=!0),a.push(c),this._active=this._active||!c.passive;for(var u=s.length-1;u>=0&&!(s[u].priority>=c.priority);)u--;s.splice(u+1,0,c)}},{key:"remove",value:function(t,e){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var a=n[i];if(a.type===t&&a.handler===e){n.splice(i,1);var o=r.get(a.srcElement);o.splice(o.indexOf(a),1),0===o.length&&r.delete(a.srcElement)}}this._active=n.some((function(t){return!t.passive}))}},{key:"handleEvent",value:function(t){if(!this.isEmpty()){for(var e=this._normalizeEvent(t),n=t.srcEvent.target;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}}},{key:"_emit",value:function(t,e){var n=this.handlersByElement.get(e);if(n){for(var r=!1,i=function(){t.handled=!0},a=function(){t.handled=!0,r=!0},o=[],s=0;s<n.length;s++){var c=n[s],u=c.type,l=c.handler,h=c.once;if(l(Object.assign({},t,{type:u,stopPropagation:i,stopImmediatePropagation:a})),h&&o.push(n[s]),r)break}for(var p=0;p<o.length;p++){var f=o[p];u=f.type,l=f.handler;this.remove(u,l)}}}},{key:"_normalizeEvent",value:function(t){var e=this.eventManager.element;return Object.assign({},t,function(t){var e=Jt[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,a=n.which,o=!1,s=!1,c=!1;return 4===e||2===e&&!Number.isFinite(r)?(o=1===a,s=2===a,c=3===a):2===e?(o=Boolean(1&r),s=Boolean(4&r),c=Boolean(2&r)):1===e&&(o=0===i,s=1===i,c=2===i),{leftButton:o,middleButton:s,rightButton:c}}(t),function(t,e){var n=t.srcEvent;if(!t.center&&!Number.isFinite(n.clientX))return null;var r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),a=i.width/e.offsetWidth,o=i.height/e.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/a,y:(r.y-i.top-e.clientTop)/o}}}(t,e),{handled:!1,rootElement:e})}}]),t}(),$t={events:null,recognizers:null,recognizerOptions:{},Manager:St,touchAction:"none",tabIndex:0},te=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(f.a)(this,t),this.options=Object.assign({},$t,n),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);var r=n.events;r&&this.on(r)}return Object(v.a)(t,[{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;for(var i in this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||It}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Ct).forEach((function(t){var n=e.manager.get(t);n&&Ct[t].forEach((function(t){n.recognizeWith(t)}))})),n.recognizerOptions){var a=this.manager.get(i);if(a){var o=n.recognizerOptions[i];delete o.enable,a.set(o)}}this.wheelInput=new Gt(t,this._onOtherEvent,{enable:!1}),this.moveInput=new qt(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Wt(t,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Yt(t,this._onOtherEvent,{enable:!1});var s=!0,c=!1,u=void 0;try{for(var l,h=this.events[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var p=Object(C.a)(l.value,2),f=p[0],d=p[1];d.isEmpty()||(this._toggleRecognizer(d.recognizerName,!0),this.manager.on(f,d.handleEvent))}}catch(v){c=!0,u=v}finally{try{s||null==h.return||h.return()}finally{if(c)throw u}}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){this._addEventHandler(t,e,n,!1)}},{key:"once",value:function(t,e,n){this._addEventHandler(t,e,n,!0)}},{key:"watch",value:function(t,e,n){this._addEventHandler(t,e,n,!1,!0)}},{key:"off",value:function(t,e){this._removeEventHandler(t,e)}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});var i=Rt[t];i&&!this.options.recognizers&&i.forEach((function(i){var a=n.get(i);e?(a.requireFailure(t),r.dropRequireFailure(i)):a.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e,n,r,i){if("string"==typeof t){var a=this.manager,o=this.events,s=Ut[t]||t,c=o.get(s);c||(c=new Qt(this),o.set(s,c),c.recognizerName=zt[s]||s,a&&a.on(s,c.handleEvent)),c.add(t,e,n,r,i),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}else for(var u in n=e,t)this._addEventHandler(u,t[u],n,r,i)}},{key:"_removeEventHandler",value:function(t,e){if("string"==typeof t){var n=this.events,r=Ut[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){var a=i.recognizerName,o=!1,s=!0,c=!1,u=void 0;try{for(var l,h=n.values()[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var p=l.value;if(p.recognizerName===a&&!p.isEmpty()){o=!0;break}}}catch(d){c=!0,u=d}finally{try{s||null==h.return||h.return()}finally{if(c)throw u}}o||this._toggleRecognizer(a,!1)}}else for(var f in t)this._removeEventHandler(f,t[f])}},{key:"_onBasicInput",value:function(t){var e=t.srcEvent,n=Dt[e.type];n&&this.manager.emit(n,t)}},{key:"_onOtherEvent",value:function(t){this.manager.emit(t.type,t)}}]),t}();var ee={transitionDuration:0},ne={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new et,transitionInterruption:gt},re=["wheel"],ie=["panstart","panmove","panend"],ae=["pinchstart","pinchmove","pinchend","pinchcancel"],oe=["doubletap"],se=["keydown"],ce=function(){function t(){var e=this;Object(f.a)(this,t),Object(h.a)(this,"events",[]),Object(h.a)(this,"mapState",void 0),Object(h.a)(this,"onViewportChange",void 0),Object(h.a)(this,"onStateChange",void 0),Object(h.a)(this,"mapStateProps",void 0),Object(h.a)(this,"eventManager",void 0),Object(h.a)(this,"scrollZoom",!0),Object(h.a)(this,"dragPan",!0),Object(h.a)(this,"dragRotate",!0),Object(h.a)(this,"doubleClickZoom",!0),Object(h.a)(this,"touchZoom",!0),Object(h.a)(this,"touchRotate",!1),Object(h.a)(this,"keyboard",!0),Object(h.a)(this,"_state",{isDragging:!1}),Object(h.a)(this,"_events",{}),Object(h.a)(this,"_transitionManager",new wt),Object(h.a)(this,"setState",(function(t){Object.assign(e._state,t),e.onStateChange&&e.onStateChange(e._state)})),this.handleEvent=this.handleEvent.bind(this),this._onWheelEnd=function(t,e){var n,r,i,a=function(){return i=null,t.apply(n,r)};return function(){n=this,r=arguments,i&&clearTimeout(i),i=setTimeout(a,e)}}(this._onWheelEnd,100)}return Object(v.a)(t,[{key:"handleEvent",value:function(t){switch(this.mapState=this.getMapState(),t.type){case"panstart":return this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchcancel":case"pinchend":return this._onPinchEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.mapState?this.mapState.getViewportProps():{},i=Object.assign({},t.getViewportProps(),e),a=Object.keys(i).some((function(t){return r[t]!==i[t]}));a&&this.onViewportChange(i,n,r),this.setState(Object.assign({},t.getInteractiveState(),n))}},{key:"getMapState",value:function(t){return new ot(Object.assign({},this.mapStateProps,this._state,t))}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,r=t.eventManager,i=void 0===r?this.eventManager:r,a=t.isInteractive,o=void 0===a||a,s=t.scrollZoom,c=void 0===s?this.scrollZoom:s,u=t.dragPan,l=void 0===u?this.dragPan:u,h=t.dragRotate,p=void 0===h?this.dragRotate:h,f=t.doubleClickZoom,d=void 0===f?this.doubleClickZoom:f,v=t.touchZoom,y=void 0===v?this.touchZoom:v,b=t.touchRotate,g=void 0===b?this.touchRotate:b,m=t.keyboard,_=void 0===m?this.keyboard:m;this.onViewportChange=e,this.onStateChange=n;var O=!this.mapStateProps||this.mapStateProps.height!==t.height;this.mapStateProps=t,O&&this.updateViewport(new ot(t)),this._transitionManager.processViewportChange(Object.assign({},t,{onStateChange:this.setState})),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(re,o&&c),this.toggleEvents(ie,o&&(l||p)),this.toggleEvents(ae,o&&(y||g)),this.toggleEvents(oe,o&&d),this.toggleEvents(se,o&&_),this.scrollZoom=c,this.dragPan=l,this.dragRotate=p,this.doubleClickZoom=d,this.touchZoom=y,this.touchRotate=g,this.keyboard=_}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,ee,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return this.isFunctionKeyPressed(t)||t.rightButton?this._onPanRotate(t):this._onPanMove(t)}},{key:"_onPanEnd",value:function(t){var e=this.mapState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isRotating:!1}),!0}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,ee,{isPanning:!0}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=t.deltaX,n=t.deltaY,r=this.getCenter(t),i=Object(C.a)(r,2)[1],a=i-n,o=this.mapState.getViewportProps(),s=o.width,c=o.height,u=e/s,l=0;n>0?Math.abs(c-a)>5&&(l=n/(a-c)*1.2):n<0&&a>5&&(l=1-i/a),l=Math.min(1,Math.max(-1,l));var h=this.mapState.rotate({deltaScaleX:u,deltaScaleY:l});return this.updateViewport(h,ee,{isRotating:!0}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.preventDefault();var e=this.getCenter(t),n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.mapState.zoom({pos:e,scale:r});return this.updateViewport(i,ee,{isZooming:!0}),this._onWheelEnd(),!0}},{key:"_onWheelEnd",value:function(){this.setState({isZooming:!1})}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,ee,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,a=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-a)/180})}return this.updateViewport(e,ee,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),!0}},{key:"_onPinchEnd",value:function(t){var e=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),r=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,Object.assign({},ne,{transitionInterpolator:new et({around:e})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:r.zoom-2}):this.getMapState({zoom:r.zoom-1});break;case 187:e=n?this.getMapState({zoom:r.zoom+2}):this.getMapState({zoom:r.zoom+1});break;case 37:e=n?this.getMapState({bearing:r.bearing-15}):this.mapState.pan({pos:[100,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:r.bearing+15}):this.mapState.pan({pos:[-100,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:r.pitch+10}):this.mapState.pan({pos:[0,100],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:r.pitch-10}):this.mapState.pan({pos:[0,-100],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,ne)}}]),t}(),ue=[{old:"onChangeViewport",new:"onViewportChange"},{old:"perspectiveEnabled",new:"dragRotate"},{old:"onHoverFeatures",new:"onHover"},{old:"onClickFeatures",new:"onClick"},{old:"touchZoomRotate",new:"touchZoom, touchRotate"},{old:"mapControls",new:"controller"}];function le(t){return"react-map-gl: `".concat(t,"` is removed.")}function he(t){return"Use `".concat(t,"` instead.")}function pe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ue.forEach((function(e){if(t.hasOwnProperty(e.old)){var n=le(e.old);e.new&&(n="".concat(n," ").concat(he(e.new))),console.warn(n)}}))}function fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var de=Object.assign({},yt.propTypes,{maxZoom:_.a.number,minZoom:_.a.number,maxPitch:_.a.number,minPitch:_.a.number,onViewStateChange:_.a.func,onViewportChange:_.a.func,onInteractionStateChange:_.a.func,transitionDuration:_.a.oneOfType([_.a.number,_.a.string]),transitionInterpolator:_.a.object,transitionInterruption:_.a.number,transitionEasing:_.a.func,onTransitionStart:_.a.func,onTransitionInterrupt:_.a.func,onTransitionEnd:_.a.func,scrollZoom:_.a.bool,dragPan:_.a.bool,dragRotate:_.a.bool,doubleClickZoom:_.a.bool,touchZoom:_.a.bool,touchRotate:_.a.bool,keyboard:_.a.bool,onHover:_.a.func,onClick:_.a.func,onDblClick:_.a.func,onContextMenu:_.a.func,onMouseDown:_.a.func,onMouseMove:_.a.func,onMouseUp:_.a.func,onTouchStart:_.a.func,onTouchMove:_.a.func,onTouchEnd:_.a.func,onMouseEnter:_.a.func,onMouseLeave:_.a.func,onMouseOut:_.a.func,onWheel:_.a.func,touchAction:_.a.string,clickRadius:_.a.number,interactiveLayerIds:_.a.array,getCursor:_.a.func,controller:_.a.instanceOf(ce)}),ve=Object.assign({},yt.defaultProps,nt,wt.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}}),ye=function(t){Object(y.a)(n,t);var e=fe(n);function n(t){var r;return Object(f.a)(this,n),r=e.call(this,t),Object(h.a)(Object(d.a)(r),"state",{isLoaded:!1,isDragging:!1,isHovering:!1}),Object(h.a)(Object(d.a)(r),"_controller",void 0),Object(h.a)(Object(d.a)(r),"_eventManager",void 0),Object(h.a)(Object(d.a)(r),"_interactiveContext",void 0),Object(h.a)(Object(d.a)(r),"_width",0),Object(h.a)(Object(d.a)(r),"_height",0),Object(h.a)(Object(d.a)(r),"_eventCanvasRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(r),"_staticMapRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(r),"getMap",(function(){return r._staticMapRef.current?r._staticMapRef.current.getMap():null})),Object(h.a)(Object(d.a)(r),"queryRenderedFeatures",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.getMap();return n&&n.queryRenderedFeatures(t,e)})),Object(h.a)(Object(d.a)(r),"_onInteractionStateChange",(function(t){var e=t.isDragging,n=void 0!==e&&e;n!==r.state.isDragging&&(r._updateInteractiveContext({isDragging:n}),r.setState({isDragging:n}));var i=r.props.onInteractionStateChange;i&&i(t)})),Object(h.a)(Object(d.a)(r),"_onResize",(function(t){var e=t.width,n=t.height;r._width=e,r._height=n,r._setControllerProps(r.props),r.props.onResize({width:e,height:n})})),Object(h.a)(Object(d.a)(r),"_onViewportChange",(function(t,e,n){var i=r.props,a=i.onViewStateChange,o=i.onViewportChange;a&&a({viewState:t,interactionState:e,oldViewState:n}),o&&o(t,e,n)})),Object(h.a)(Object(d.a)(r),"_onLoad",(function(t){r.setState({isLoaded:!0}),r.props.onLoad(t)})),Object(h.a)(Object(d.a)(r),"_onEvent",(function(t,e){var n=r.props[t];n&&n(r._normalizeEvent(e))})),Object(h.a)(Object(d.a)(r),"_onPointerDown",(function(t){switch(t.pointerType){case"touch":r._onEvent("onTouchStart",t);break;default:r._onEvent("onMouseDown",t)}})),Object(h.a)(Object(d.a)(r),"_onPointerUp",(function(t){switch(t.pointerType){case"touch":r._onEvent("onTouchEnd",t);break;default:r._onEvent("onMouseUp",t)}})),Object(h.a)(Object(d.a)(r),"_onPointerMove",(function(t){switch(t.pointerType){case"touch":r._onEvent("onTouchMove",t);break;default:r._onEvent("onMouseMove",t)}if(!r.state.isDragging){var e,n=r.props,i=n.onHover,a=n.interactiveLayerIds;t=r._normalizeEvent(t),r.state.isLoaded&&(a||i)&&(e=r._getFeatures({pos:t.point,radius:r.props.clickRadius})),i&&(t.features=e,i(t));var o=Boolean(a&&e&&e.length>0),s=o&&!r.state.isHovering,c=!o&&r.state.isHovering;s&&r._onEvent("onMouseEnter",t),c&&r._onEvent("onMouseLeave",t),(s||c)&&r.setState({isHovering:o})}})),Object(h.a)(Object(d.a)(r),"_onClick",(function(t){var e=r.props,n=e.onClick,i=e.onNativeClick,a=e.onDblClick,o=e.doubleClickZoom,s=[],c=a||o;switch(t.type){case"anyclick":s.push(i),c||s.push(n);break;case"click":c&&s.push(n)}(s=s.filter(Boolean)).length&&((t=r._normalizeEvent(t)).features=r._getFeatures({pos:t.point,radius:r.props.clickRadius}),s.forEach((function(e){return e(t)})))})),pe(t),r._controller=t.controller||new ce,r._eventManager=new te(null,{touchAction:t.touchAction}),r._updateInteractiveContext({isDragging:!1,eventManager:r._eventManager}),r}return Object(v.a)(n,null,[{key:"supported",value:function(){return yt.supported()}}]),Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this._eventManager,e=this._eventCanvasRef.current;t.setElement(e),t.on({pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointerleave:this._onEvent.bind(this,"onMouseOut"),click:this._onClick,anyclick:this._onClick,dblclick:this._onEvent.bind(this,"onDblClick"),wheel:this._onEvent.bind(this,"onWheel"),contextmenu:this._onEvent.bind(this,"onContextMenu")}),this._setControllerProps(this.props),this._updateInteractiveContext({mapContainer:e})}},{key:"componentDidUpdate",value:function(){this._setControllerProps(this.props)}},{key:"componentWillUnmount",value:function(){this._eventManager.destroy()}},{key:"_setControllerProps",value:function(t){t=Object.assign({},t,t.viewState,{isInteractive:Boolean(t.onViewStateChange||t.onViewportChange),onViewportChange:this._onViewportChange,onStateChange:this._onInteractionStateChange,eventManager:this._eventManager,width:this._width,height:this._height}),this._controller.setOptions(t);var e=this._interactiveContext;e.onViewportChange=t.onViewportChange,e.onViewStateChange=t.onViewStateChange}},{key:"_getFeatures",value:function(t){var e,n=t.pos,r=t.radius,i={},a=this.getMap();if(this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds),r){var o=r,s=[[n[0]-o,n[1]+o],[n[0]+o,n[1]-o]];e=a&&a.queryRenderedFeatures(s,i)}else e=a&&a.queryRenderedFeatures(n,i);return e}},{key:"_updateInteractiveContext",value:function(t){this._interactiveContext=Object.assign({},this._interactiveContext,t)}},{key:"_normalizeEvent",value:function(t){if(t.lngLat)return t;var e=t.offsetCenter,n=[e.x,e.y],r=new x.a(Object.assign({},this.props,{width:this._width,height:this._height}));return t.point=n,t.lngLat=r.unproject(n),t}},{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,r=t.style,i=t.getCursor,a=Object.assign({position:"relative"},r,{width:e,height:n,cursor:i(this.state)});return c.createElement(ct.Provider,{value:this._interactiveContext},c.createElement("div",{key:"event-canvas",ref:this._eventCanvasRef,style:a},c.createElement(yt,Object(p.a)({},this.props,{width:"100%",height:"100%",style:null,onResize:this._onResize,onLoad:this._onLoad,ref:this._staticMapRef}),this.props.children)))}}]),n}(c.PureComponent);function be(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!be(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===Object(Xt.a)(t)&&"object"===Object(Xt.a)(e)){var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var a=0,o=r;a<o.length;a++){var s=o[a];if(!e.hasOwnProperty(s))return!1;if(!be(t[s],e[s]))return!1}return!0}return!1}function ge(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(ye,"propTypes",de),Object(h.a)(ye,"defaultProps",ve);var me={type:_.a.string.isRequired,id:_.a.string},_e=0,Oe=function(t){Object(y.a)(n,t);var e=ge(n);function n(t){var r;return Object(f.a)(this,n),r=e.call(this,t),Object(h.a)(Object(d.a)(r),"id",void 0),Object(h.a)(Object(d.a)(r),"type",void 0),Object(h.a)(Object(d.a)(r),"_map",null),Object(h.a)(Object(d.a)(r),"_sourceOptions",{}),Object(h.a)(Object(d.a)(r),"_updateSource",(function(){var t=Object(d.a)(r),e=t.type;if(t._map){var n=Object(d.a)(r),i=n._sourceOptions,a=n.props;M(!a.id||a.id===r.id,"source id changed"),M(a.type===e,"source type changed");var o="",s=0;for(var c in a)"children"===c||"id"===c||be(i[c],a[c])||(i[c]=a[c],o=c,s++);var u=r.getSource();if(u){if(s)if("geojson"===e)u.setData(i.data);else if("image"===e)u.updateImage({url:i.url,coordinates:i.coordinates});else if("canvas"!==e&&"video"!==e||1!==s||"coordinates"!==o)if("vector"===e&&u.setUrl)switch(o){case"url":u.setUrl(i.url);break;case"tiles":u.setTiles(i.tiles)}else console.warn("Unable to update <Source> prop: ".concat(o));else u.setCoordinates(i.coordinates)}else r._createSource(i)}})),r.id=t.id||"jsx-source-".concat(_e++),r.type=t.type,r}return Object(v.a)(n,[{key:"componentWillUnmount",value:function(){var t=this,e=this._map;e&&(e.off("styledata",this._updateSource),requestAnimationFrame((function(){e.style&&e.style._loaded&&e.removeSource(t.id)})))}},{key:"getSource",value:function(){var t=this._map;return t&&t.style&&t.getSource(this.id)}},{key:"_createSource",value:function(t){var e=this._map;e.style&&e.style._loaded&&e.addSource(this.id,t)}},{key:"_render",value:function(t){var e=this;return!this._map&&t.map&&(this._map=t.map,this._map.on("styledata",this._updateSource)),this._updateSource(),c.Children.map(this.props.children,(function(t){return Object(c.cloneElement)(t,{source:e.id})}))}},{key:"render",value:function(){return c.createElement(ct.Consumer,null,this._render.bind(this))}}]),n}(c.PureComponent);Object(h.a)(Oe,"propTypes",me);var je=n("Ff2n");function we(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var Ee={type:_.a.oneOf(Object.keys({fill:"fill",line:"line",symbol:"symbol",circle:"circle",fillExtrusion:"fill-extrusion",raster:"raster",background:"background",heatmap:"heatmap",hillshade:"hillshade"})).isRequired,id:_.a.string,source:_.a.string,beforeId:_.a.string};var Te=0,ke=function(t){Object(y.a)(n,t);var e=we(n);function n(t){var r;return Object(f.a)(this,n),r=e.call(this,t),Object(h.a)(Object(d.a)(r),"id",void 0),Object(h.a)(Object(d.a)(r),"type",void 0),Object(h.a)(Object(d.a)(r),"_map",null),Object(h.a)(Object(d.a)(r),"_layerOptions",{}),Object(h.a)(Object(d.a)(r),"_updateLayer",(function(){var t=r._map;if(t){var e=Object(d.a)(r),n=e.props,i=e._layerOptions;if(M(!n.id||n.id===r.id,"layer id changed"),M(n.type===r.type,"layer type changed"),r.getLayer())try{!function(t,e,n,r){var i=n.layout,a=void 0===i?{}:i,o=n.paint,s=void 0===o?{}:o,c=n.filter,u=n.minzoom,l=n.maxzoom,h=n.beforeId,p=Object(je.a)(n,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==r.beforeId&&t.moveLayer(e,h),a!==r.layout){for(var f in a)be(a[f],r.layout[f])||t.setLayoutProperty(e,f,a[f]);for(var d in r.layout)a.hasOwnProperty(d)||t.setLayoutProperty(e,d,void 0)}if(s!==r.paint){for(var v in s)be(s[v],r.paint[v])||t.setPaintProperty(e,v,s[v]);for(var y in r.paint)s.hasOwnProperty(y)||t.setPaintProperty(e,y,void 0)}for(var b in be(c,r.filter)||t.setFilter(e,c),u===r.minzoom&&l===r.maxzoom||t.setLayerZoomRange(e,u,l),p)be(p[b],r[b])||t.setLayerProperty(e,b,p[b])}(t,r.id,n,i),Object.assign(i,n)}catch(a){console.warn(a)}else r._createLayer()}})),r.id=t.id||"jsx-layer-".concat(Te++),r.type=t.type,r}return Object(v.a)(n,[{key:"componentDidMount",value:function(){this._updateLayer()}},{key:"componentDidUpdate",value:function(){this._updateLayer()}},{key:"componentWillUnmount",value:function(){var t=this._map;t&&(t.off("styledata",this._updateLayer),t.style&&t.style._loaded&&t.removeLayer(this.id))}},{key:"getLayer",value:function(){var t=this._map;return t&&t.style&&t.getLayer(this.id)}},{key:"_createLayer",value:function(){var t=this._map;if(t.style&&t.style._loaded){var e=Object.assign({},this.props);e.id=this.id,delete e.beforeId,t.addLayer(e,this.props.beforeId),this._layerOptions=e}}},{key:"_render",value:function(t){return!this._map&&t.map&&(this._map=t.map,this._map.on("styledata",this._updateLayer)),null}},{key:"render",value:function(){return c.createElement(ct.Consumer,null,this._render.bind(this))}}]),n}(c.PureComponent);function xe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(ke,"propTypes",Ee);var Pe={captureScroll:_.a.bool,captureDrag:_.a.bool,captureClick:_.a.bool,captureDoubleClick:_.a.bool},Se=function(t){Object(y.a)(n,t);var e=xe(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"_context",{}),Object(h.a)(Object(d.a)(t),"_events",null),Object(h.a)(Object(d.a)(t),"_containerRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(t),"_onScroll",(function(e){t.props.captureScroll&&e.stopPropagation()})),Object(h.a)(Object(d.a)(t),"_onDragStart",(function(e){t.props.captureDrag&&e.stopPropagation()})),Object(h.a)(Object(d.a)(t),"_onDblClick",(function(e){t.props.captureDoubleClick&&e.stopPropagation()})),Object(h.a)(Object(d.a)(t),"_onClick",(function(e){t.props.captureClick&&e.stopPropagation()})),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;if(t){var e=this._context.eventManager;e&&(this._events={wheel:this._onScroll,panstart:this._onDragStart,anyclick:this._onClick,click:this._onClick,dblclick:this._onDblClick},e.watch(this._events,t))}}},{key:"componentWillUnmount",value:function(){var t=this._context.eventManager;t&&this._events&&t.off(this._events)}},{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){var t=this;return c.createElement(ct.Consumer,null,(function(e){return t._context=e,t._render()}))}}]),n}(c.PureComponent);Object(h.a)(Se,"propTypes",Pe),Object(h.a)(Se,"defaultProps",{captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0});var Ae=n("ReuC");function Ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var Ce=Object.assign({},Se.propTypes,{draggable:_.a.bool,onDrag:_.a.func,onDragEnd:_.a.func,onDragStart:_.a.func,offsetLeft:_.a.number,offsetTop:_.a.number}),Re=Object.assign({},Se.defaultProps,{draggable:!1,offsetLeft:0,offsetTop:0}),De=function(t){Object(y.a)(n,t);var e=Ie(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"state",{dragPos:null,dragOffset:null}),Object(h.a)(Object(d.a)(t),"_dragEvents",null),Object(h.a)(Object(d.a)(t),"_onDragStart",(function(e){var n=t.props,r=n.draggable,i=n.captureDrag;if((r||i)&&e.stopPropagation(),r){var a=t._getDragEventPosition(e),o=t._getDragEventOffset(e);t.setState({dragPos:a,dragOffset:o}),t._setupDragEvents();var s=t.props.onDragStart;if(s&&o){var c=Object.assign({},e);c.lngLat=t._getDragLngLat(a,o),s(c)}}})),Object(h.a)(Object(d.a)(t),"_onDrag",(function(e){e.stopPropagation();var n=t._getDragEventPosition(e);t.setState({dragPos:n});var r=t.props.onDrag,i=t.state.dragOffset;if(r&&i){var a=Object.assign({},e);a.lngLat=t._getDragLngLat(n,i),r(a)}})),Object(h.a)(Object(d.a)(t),"_onDragEnd",(function(e){var n=t.state,r=n.dragPos,i=n.dragOffset;e.stopPropagation(),t.setState({dragPos:null,dragOffset:null}),t._removeDragEvents();var a=t.props.onDragEnd;if(a&&r&&i){var o=Object.assign({},e);o.lngLat=t._getDragLngLat(r,i),a(o)}})),Object(h.a)(Object(d.a)(t),"_onDragCancel",(function(e){e.stopPropagation(),t.setState({dragPos:null,dragOffset:null}),t._removeDragEvents()})),t}return Object(v.a)(n,[{key:"componentWillUnmount",value:function(){Object(Ae.a)(Object(g.a)(n.prototype),"componentWillUnmount",this).call(this),this._removeDragEvents()}},{key:"_setupDragEvents",value:function(){var t=this._context.eventManager;t&&(this._dragEvents={panmove:this._onDrag,panend:this._onDragEnd,pancancel:this._onDragCancel},t.on(this._dragEvents))}},{key:"_removeDragEvents",value:function(){var t=this._context.eventManager;t&&this._dragEvents&&(t.off(this._dragEvents),this._dragEvents=null)}},{key:"_getDragEventPosition",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"_getDragEventOffset",value:function(t){var e=t.center,n=e.x,r=e.y,i=this._containerRef.current;if(i){var a=i.getBoundingClientRect();return[a.left-n,a.top-r]}return null}},{key:"_getDraggedPosition",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"_getDragLngLat",value:function(t,e){var n=this.props,r=n.offsetLeft,i=n.offsetTop,a=this._getDraggedPosition(t,e),o=Object(C.a)(a,2),s=o[0],c=o[1];return this._context.viewport.unproject([s-r,c-i])}}]),n}(Se);Object(h.a)(De,"propTypes",Ce),Object(h.a)(De,"defaultProps",Re);var Le="undefined"!=typeof window&&window.devicePixelRatio||1,Ne=function(t){return Math.round(t*Le)/Le},Me=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===t)return e;var r="x"===n?t.offsetWidth:t.offsetHeight;return Ne(e/100*r)/r*100};function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var Ue=Object.assign({},De.propTypes,{className:_.a.string,longitude:_.a.number.isRequired,latitude:_.a.number.isRequired}),Be=Object.assign({},De.defaultProps,{className:""}),Fe=function(t){Object(y.a)(n,t);var e=ze(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"_control",null),t}return Object(v.a)(n,[{key:"_getPosition",value:function(){var t=this.props,e=t.longitude,n=t.latitude,r=t.offsetLeft,i=t.offsetTop,a=this.state,o=a.dragPos,s=a.dragOffset;if(o&&s)return this._getDraggedPosition(o,s);var c=this._context.viewport.project([e,n]),u=Object(C.a)(c,2),l=u[0],h=u[1];return[l+=r,h+=i]}},{key:"_render",value:function(){var t=this._getPosition(),e=Object(C.a)(t,2),n=e[0],r=e[1],i="translate(".concat(Ne(n),"px, ").concat(Ne(r),"px)"),a=this._containerRef.current;if(this._control&&a)a.style.transform=i;else{var o=this.props,s=o.className,u=o.draggable,l=this.state.dragPos,h={position:"absolute",left:0,top:0,transform:i,cursor:u?l?"grabbing":"grab":"auto"};this._control=c.createElement("div",{className:"mapboxgl-marker ".concat(s),ref:this._containerRef,style:h},this.props.children)}return this._control}},{key:"render",value:function(){return this._control=null,Object(Ae.a)(Object(g.a)(n.prototype),"render",this).call(this)}}]),n}(De);Object(h.a)(Fe,"propTypes",Ue),Object(h.a)(Fe,"defaultProps",Be);var Ve={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},Ge=Object.keys(Ve);function He(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var qe=Object.assign({},Se.propTypes,{className:_.a.string,longitude:_.a.number.isRequired,latitude:_.a.number.isRequired,altitude:_.a.number,offsetLeft:_.a.number,offsetTop:_.a.number,tipSize:_.a.number,closeButton:_.a.bool,closeOnClick:_.a.bool,anchor:_.a.oneOf(Object.keys(Ve)),dynamicPosition:_.a.bool,sortByDepth:_.a.bool,onClose:_.a.func}),Ze=Object.assign({},Se.defaultProps,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}}),We=function(t){Object(y.a)(n,t);var e=He(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"_closeOnClick",!1),Object(h.a)(Object(d.a)(t),"_contentRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(t),"_onClick",(function(e){if(t.props.captureClick&&e.stopPropagation(),t.props.closeOnClick||"mapboxgl-popup-close-button"===e.target.className){t.props.onClose();var n=t._context.eventManager;n&&n.once("click",(function(t){return t.stopPropagation()}),e.target)}})),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){Object(Ae.a)(Object(g.a)(n.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"_getPosition",value:function(t,e){var n=this._context.viewport,r=this.props,i=r.anchor,a=r.dynamicPosition,o=r.tipSize,s=this._contentRef.current;return s&&a?function(t){var e=t.x,n=t.y,r=t.width,i=t.height,a=t.selfWidth,o=t.selfHeight,s=t.anchor,c=t.padding,u=void 0===c?0:c,l=Ve[s],h=l.x,p=l.y,f=n-p*o,d=f+o;if(f<u)for(;f<u&&p>=.5;)p-=.5,f+=.5*o;else if(d>i-u)for(;d>i-u&&p<=.5;)p+=.5,d-=.5*o;var v=e-h*a,y=v+a,b=.5;if(.5===p&&(h=Math.floor(h),b=1),v<u)for(;v<u&&h>=b;)h-=b,v+=b*a;else if(y>r-u)for(;y>r-u&&h<=1-b;)h+=b,y-=b*a;return Ge.find((function(t){var e=Ve[t];return e.x===h&&e.y===p}))||s}({x:t,y:e,anchor:i,padding:o,width:n.width,height:n.height,selfWidth:s.clientWidth,selfHeight:s.clientHeight}):i}},{key:"_getContainerStyle",value:function(t,e,n,r){var i=this._context.viewport,a=this.props,o=a.offsetLeft,s=a.offsetTop,c=a.sortByDepth,u=Ve[r],l=t+o,h=e+s,p=this._containerRef.current,f=Me(p,100*-u.x),d=Me(p,100*-u.y,"y"),v={position:"absolute",transform:"\n        translate(".concat(f,"%, ").concat(d,"%)\n        translate(").concat(Ne(l),"px, ").concat(Ne(h),"px)\n      "),display:void 0,zIndex:void 0};return c?(n>1||n<-1||t<0||t>i.width||e<0||e>i.height?v.display="none":v.zIndex=Math.floor((1-n)/2*1e5),v):v}},{key:"_renderTip",value:function(t){var e=this.props.tipSize;return c.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:e}})}},{key:"_renderContent",value:function(){var t=this.props,e=t.closeButton,n=t.children,r=this._context.eventManager?null:this._onClick;return c.createElement("div",{key:"content",ref:this._contentRef,className:"mapboxgl-popup-content",onClick:r},e&&c.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},"×"),n)}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.longitude,r=t.latitude,i=t.altitude,a=this._context.viewport.project([n,r,i]),o=Object(C.a)(a,3),s=o[0],u=o[1],l=o[2],h=this._getPosition(s,u),p=this._getContainerStyle(s,u,l,h);return c.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(h," ").concat(e),style:p,ref:this._containerRef},this._renderTip(h),this._renderContent())}}]),n}(Se);Object(h.a)(We,"propTypes",qe),Object(h.a)(We,"defaultProps",Ze);var Ye=n("oJR1");function Xe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}var Je,Ke=Object.assign({},Se.propTypes,{className:_.a.string,container:_.a.object,label:_.a.string}),Qe=Object.assign({},Se.defaultProps,{className:"",container:null,label:"Toggle fullscreen"}),$e=function(t){Object(y.a)(n,t);var e=Xe(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"state",{isFullscreen:!1,showButton:!1}),Object(h.a)(Object(d.a)(t),"_mapboxFullscreenControl",null),Object(h.a)(Object(d.a)(t),"_onFullscreenChange",(function(){var e=!t._mapboxFullscreenControl._fullscreen;t._mapboxFullscreenControl._fullscreen=e,t.setState({isFullscreen:e})})),Object(h.a)(Object(d.a)(t),"_onClickFullscreen",(function(){t._mapboxFullscreenControl._onClickFullscreen()})),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.container||this._context.mapContainer;this._mapboxFullscreenControl=new I.a.FullscreenControl({container:t}),this.setState({showButton:this._mapboxFullscreenControl._checkFullscreenSupport()}),Ye.a.addEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"componentWillUnmount",value:function(){Ye.a.removeEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"_renderButton",value:function(t,e,n){return c.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},c.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){if(!this.state.showButton)return null;var t=this.props,e=t.className,n=t.label,r=this.state.isFullscreen?"shrink":"fullscreen";return c.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef},this._renderButton(r,n,this._onClickFullscreen))}}]),n}(Se);function tn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)($e,"propTypes",Ke),Object(h.a)($e,"defaultProps",Qe);var en=Object.assign({},wt.defaultProps,{transitionDuration:500}),nn=function(){},rn=Object.assign({},Se.propTypes,{className:_.a.string,style:_.a.object,label:_.a.string,auto:_.a.bool,positionOptions:_.a.object,fitBoundsOptions:_.a.object,trackUserLocation:_.a.bool,showUserLocation:_.a.bool,onViewStateChange:_.a.func,onViewportChange:_.a.func,onGeolocate:_.a.func}),an=Object.assign({},Se.defaultProps,{className:"",style:{},label:"Geolocate",auto:!1,positionOptions:null,fitBoundsOptions:null,trackUserLocation:!1,showUserLocation:!0,onGeolocate:function(){}}),on=function(t){Object(y.a)(n,t);var e=tn(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"state",{supportsGeolocation:!1,markerPosition:null}),Object(h.a)(Object(d.a)(t),"_mapboxGeolocateControl",null),Object(h.a)(Object(d.a)(t),"_geolocateButtonRef",Object(c.createRef)()),Object(h.a)(Object(d.a)(t),"_setupMapboxGeolocateControl",(function(e){if(e){var n={showUserLocation:!1};["positionOptions","fitBoundsOptions","trackUserLocation"].forEach((function(e){e in t.props&&null!==t.props[e]&&(n[e]=t.props[e])}));var r=new I.a.GeolocateControl(n);t._mapboxGeolocateControl=r,r._watchState="OFF",r._geolocateButton=t._geolocateButtonRef.current,r.options.trackUserLocation&&r._geolocateButton&&r._geolocateButton.setAttribute("aria-pressed","false"),r._updateMarker=t._updateMarker,r._updateCamera=t._updateCamera,r._setup=!0;var i=t._context.eventManager;r.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===r._watchState&&(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"))})),r.on("geolocate",t.props.onGeolocate)}else console.warn("Geolocation support is not available, the GeolocateControl will not be visible.")})),Object(h.a)(Object(d.a)(t),"_triggerGeolocate",(function(){var e=t._mapboxGeolocateControl;return e._map=t._context.map,t.props.showUserLocation&&(e.on("geolocate",t._updateMarker),e.on("trackuserlocationend",t._updateMarker)),t._mapboxGeolocateControl.trigger()})),Object(h.a)(Object(d.a)(t),"_updateMarker",(function(e){e&&t.setState({markerPosition:e.coords})})),Object(h.a)(Object(d.a)(t),"_getBounds",(function(t){var e=new I.a.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=e.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]})),Object(h.a)(Object(d.a)(t),"_updateCamera",(function(e){var n=t._context.viewport,r=t._getBounds(e),i=new x.a(n).fitBounds(r),a=i.longitude,o=i.latitude,s=i.zoom,c=Object.assign({},n,{longitude:a,latitude:o,zoom:s}),u=new ot(c),l=Object.assign({},u.getViewportProps(),en),h=t.props.onViewportChange||t._context.onViewportChange||nn;(t.props.onViewStateChange||t._context.onViewStateChange||nn)({viewState:l}),h(l)})),Object(h.a)(Object(d.a)(t),"_renderButton",(function(e,n,r){return c.createElement("button",{key:e,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(e),ref:t._geolocateButtonRef,type:"button",title:n,onClick:r},c.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))})),Object(h.a)(Object(d.a)(t),"_renderMarker",(function(){var e=t.state.markerPosition,n=t.props.showUserLocation;return e&&n?c.createElement(Fe,{key:"location-maker",className:"mapboxgl-user-location-dot",longitude:e.longitude,latitude:e.latitude,onContextMenu:function(t){return t.preventDefault()},captureDrag:!1,captureDoubleClick:!1}):null})),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this;(void 0!==Je?Promise.resolve(Je):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return Je="denied"!==t.state})):(Je=Boolean(window.navigator.geolocation),Promise.resolve(Je))).then((function(e){t.setState({supportsGeolocation:e}),t._setupMapboxGeolocateControl(e),e&&t.props.auto&&t._triggerGeolocate()}))}},{key:"componentDidUpdate",value:function(t){this.state.supportsGeolocation&&!t.auto&&this.props.auto&&this._triggerGeolocate()}},{key:"componentWillUnmount",value:function(){if(this._mapboxGeolocateControl){var t=this._mapboxGeolocateControl._geolocationWatchID;void 0!==t&&(window.navigator.geolocation.clearWatch(t),this._mapboxGeolocateControl._geolocationWatchID=void 0)}}},{key:"_render",value:function(){if(!this.state.supportsGeolocation)return null;var t=this.props,e=t.className,n=t.style,r=t.label;return c.createElement("div",null,this._renderMarker(),c.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef,style:n,onContextMenu:function(t){return t.preventDefault()}},this._renderButton("geolocate",r,this._triggerGeolocate)))}}]),n}(Se);function sn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(on,"propTypes",rn),Object(h.a)(on,"defaultProps",an);var cn=function(){},un=Object.assign({},Se.propTypes,{className:_.a.string,onViewStateChange:_.a.func,onViewportChange:_.a.func,showCompass:_.a.bool,showZoom:_.a.bool,zoomInLabel:_.a.string,zoomOutLabel:_.a.string,compassLabel:_.a.string}),ln=Object.assign({},Se.defaultProps,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function hn(t){return function(t,e){for(var n=(t||"").split(".").map(Number),r=(e||"").split(".").map(Number),i=0;i<3;i++){var a=n[i]||0,o=r[i]||0;if(a<o)return-1;if(a>o)return 1}return 0}(t,"1.6.0")>=0?2:1}var pn=function(t){Object(y.a)(n,t);var e=sn(n);function n(t){var r;return Object(f.a)(this,n),r=e.call(this,t),Object(h.a)(Object(d.a)(r),"_uiVersion",void 0),Object(h.a)(Object(d.a)(r),"_onZoomIn",(function(){r._updateViewport({zoom:r._context.viewport.zoom+1})})),Object(h.a)(Object(d.a)(r),"_onZoomOut",(function(){r._updateViewport({zoom:r._context.viewport.zoom-1})})),Object(h.a)(Object(d.a)(r),"_onResetNorth",(function(){r._updateViewport({bearing:0,pitch:0})})),pe(t),r}return Object(v.a)(n,[{key:"_updateViewport",value:function(t){var e=this._context.viewport,n=new ot(Object.assign({},e,t)),r=Object.assign({},n.getViewportProps(),ne),i=this.props.onViewportChange||this._context.onViewportChange||cn;(this.props.onViewStateChange||this._context.onViewStateChange||cn)({viewState:r}),i(r)}},{key:"_renderCompass",value:function(){var t=this._context.viewport.bearing,e={transform:"rotate(".concat(-t,"deg)")};return 2===this._uiVersion?c.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:e}):c.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:e})}},{key:"_renderButton",value:function(t,e,n,r){return c.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},r||c.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.showCompass,r=t.showZoom,i=t.zoomInLabel,a=t.zoomOutLabel,o=t.compassLabel;if(!this._uiVersion){var s=this._context.map;this._uiVersion=s?hn(s.version):2}return c.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef},r&&this._renderButton("zoom-in",i,this._onZoomIn),r&&this._renderButton("zoom-out",a,this._onZoomOut),n&&this._renderButton("compass",o,this._onResetNorth,this._renderCompass()))}}]),n}(Se);function fn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(pn,"propTypes",un),Object(h.a)(pn,"defaultProps",ln);var dn=Object.assign({},Se.propTypes,{maxWidth:_.a.number,unit:_.a.oneOf(["imperial","metric","nautical"])}),vn=Object.assign({},Se.defaultProps,{maxWidth:100,unit:"metric"}),yn=function(t){Object(y.a)(n,t);var e=fn(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"_control",null),Object(h.a)(Object(d.a)(t),"_mapboxScaleControl",null),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=new I.a.ScaleControl;t._map=this._context.map,t._container=this._containerRef.current,this._mapboxScaleControl=t,this._update()}},{key:"_update",value:function(){var t=this._mapboxScaleControl;t&&(t.options=this.props,t._onMove())}},{key:"_render",value:function(){return this._control=this._control||c.createElement("div",{ref:this._containerRef,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}),this._update(),this._control}}]),n}(Se);function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(yn,"propTypes",dn),Object(h.a)(yn,"defaultProps",vn);var gn=Object.assign({},Se.propTypes,{redraw:_.a.func.isRequired}),mn=function(t){Object(y.a)(n,t);var e=bn(n);function n(){var t;Object(f.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),Object(h.a)(Object(d.a)(t),"_canvas",void 0),Object(h.a)(Object(d.a)(t),"_ctx",void 0),Object(h.a)(Object(d.a)(t),"_redraw",(function(){var e=t._ctx;if(e){var n=Ye.b.devicePixelRatio||1;e.save(),e.scale(n,n);var r=t._context,i=r.viewport,a=r.isDragging;t.props.redraw({width:i.width,height:i.height,ctx:e,isDragging:a,project:i.project.bind(i),unproject:i.unproject.bind(i)}),e.restore()}})),t}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;t&&(this._canvas=t,this._ctx=t.getContext("2d")),this._redraw()}},{key:"_render",value:function(){var t=Ye.b.devicePixelRatio||1,e=this._context.viewport,n=e.width,r=e.height;return this._redraw(),c.createElement("canvas",{ref:this._containerRef,width:n*t,height:r*t,style:{width:"".concat(n,"px"),height:"".concat(r,"px"),position:"absolute",left:0,top:0}})}}]),n}(Se);function _n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(mn,"propTypes",gn),Object(h.a)(mn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var On=Object.assign({},Se.propTypes,{redraw:_.a.func.isRequired,style:_.a.object}),jn=function(t){Object(y.a)(n,t);var e=_n(n);function n(){return Object(f.a)(this,n),e.apply(this,arguments)}return Object(v.a)(n,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0,width:e.width,height:e.height},this.props.style);return c.createElement("div",{ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),n}(Se);function wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(g.a)(t);if(e){var i=Object(g.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(b.a)(this,n)}}Object(h.a)(jn,"propTypes",On),Object(h.a)(jn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var En=Object.assign({},Se.propTypes,{redraw:_.a.func.isRequired,style:_.a.object}),Tn=function(t){Object(y.a)(n,t);var e=wn(n);function n(){return Object(f.a)(this,n),e.apply(this,arguments)}return Object(v.a)(n,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0},this.props.style);return c.createElement("svg",{width:e.width,height:e.height,ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),n}(Se);Object(h.a)(Tn,"propTypes",En),Object(h.a)(Tn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});I.a&&I.a.setRTLTextPlugin;var kn=n("pLLy"),xn=n("49Am"),Pn=n("o0o1"),Sn=n.n(Pn),An=n("HaE+"),In=n("oCaT"),Cn=1,Rn=2,Dn="empty",Ln="scenegraph",Nn="pointcloud",Mn="TILES3D",zn="geometricError",Un={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},Bn=(Object.keys(Un),n("DYWF"));function Fn(t,e,n){Object(Bn.a)(t instanceof ArrayBuffer);var r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function Vn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}var Gn,Hn=n("7UmL"),qn=n("nGEl");function Zn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Wn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zn(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Yn(t){return Xn.apply(this,arguments)}function Xn(){return(Xn=Object(An.a)(Sn.a.mark((function t(e){var n;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.modules||{},Gn=n.draco3d?Gn||new Promise((function(t){var e=n.draco3d.createDecoderModule({onModuleLoaded:function(){t({draco:e})}})})):Gn||Jn(e),t.next=4,Gn;case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jn(t){return Kn.apply(this,arguments)}function Kn(){return(Kn=Object(An.a)(Sn.a.mark((function t(e){var n,r,i,a;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.draco&&e.draco.decoderType,t.next="js"===t.t0?3:(t.t0,7);break;case 3:return t.next=5,Object(Hn.a)("draco_decoder.js","draco",e);case 5:return n=t.sent,t.abrupt("break",21);case 7:return t.t1=Promise,t.next=10,Object(Hn.a)("draco_wasm_wrapper.js","draco",e);case 10:return t.t2=t.sent,t.next=13,Object(Hn.a)("draco_decoder.wasm","draco",e);case 13:return t.t3=t.sent,t.t4=[t.t2,t.t3],t.next=17,t.t1.all.call(t.t1,t.t4);case 17:i=t.sent,a=Object(C.a)(i,2),n=a[0],r=a[1];case 21:return n=n||qn.a.DracoDecoderModule,t.next=24,Qn(n,r);case 24:return t.abrupt("return",t.sent);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qn(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(Wn(Wn({},n),{},{onModuleLoaded:function(t){return e({draco:t})}}))}))}var $n=n("6V5v"),tr=0,er=1,nr={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},rr={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},ir=function(){function t(e){Object(f.a)(this,t),this.draco=e,this.drawMode="TRIANGLE",this.metadataQuerier={}}return Object(v.a)(t,[{key:"destroy",value:function(){}},{key:"destroyGeometry",value:function(t){t&&this.draco.destroy(t.dracoGeometry)}},{key:"parseSync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.metadataQuerier=new this.draco.MetadataQuerier;var n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength);var r,i,a,o=new this.draco.Decoder,s={};try{var c=o.GetEncodedGeometryType(n);switch(c){case this.draco.TRIANGULAR_MESH:i=new this.draco.Mesh,r=o.DecodeBufferToMesh(n,i),a={type:tr,faceCount:i.num_faces(),attributeCount:i.num_attributes(),vertexCount:i.num_points()};break;case this.draco.POINT_CLOUD:i=new this.draco.PointCloud,r=o.DecodeBufferToPointCloud(n,i),a={type:er,attributeCount:i.num_attributes(),vertexCount:i.num_points()};break;default:throw new Error("Unknown DRACO geometry type.")}if(!r.ok()||!i.ptr){var u="DRACO decompression failed: ".concat(r.error_msg());throw i&&this.draco.destroy(i),new Error(u)}s.loaderData={header:a},this._extractDRACOGeometry(o,i,c,s,e);var l=this._getGeometryMetadata(o,i);s.header={vertexCount:a.vertexCount,boundingBox:Object($n.a)(s.attributes),metadata:l}}finally{this.draco.destroy(o),this.draco.destroy(n),this.draco.destroy(i),this.draco.destroy(this.metadataQuerier)}return s}},{key:"_extractDRACOGeometry",value:function(t,e,n,r,i){var a=this._getAttributes(t,e,i);if(!a.POSITION)throw new Error("DRACO decompressor: No position attribute found.");return n===this.draco.TRIANGULAR_MESH?(a.indices="TRIANGLE_STRIP"===this.drawMode?this._getMeshStripIndices(t,e):this._getMeshFaceIndices(t,e),r.mode="TRIANGLE_STRIP"===this.drawMode?5:4):r.mode=0,a.indices&&(r.indices={value:a.indices,size:1},delete a.indices),r.attributes=a,r}},{key:"getPositionAttributeMetadata",value:function(t){this.metadata=this.metadata||{},this.metadata.attributes=this.metadata.attributes||{};var e=new this.draco.AttributeQuantizationTransform;if(e.InitFromAttribute(t)){this.metadata.attributes.position.isQuantized=!0,this.metadata.attributes.position.maxRange=e.range(),this.metadata.attributes.position.numQuantizationBits=e.quantization_bits(),this.metadata.attributes.position.minValues=new Float32Array(3);for(var n=0;n<3;++n)this.metadata.attributes.position.minValues[n]=e.min_value(n)}this.draco.destroy(e)}},{key:"_getAttributes",value:function(t,e,n){for(var r={},i=e.num_points(),a=0;a<e.num_attributes();a++){var o=t.GetAttribute(e,a),s=this._getAttributeMetadata(t,e,a),c={uniqueId:o.unique_id(),attributeType:o.attribute_type(),dataType:rr[o.data_type()],size:o.size(),numComponents:o.num_components(),byteOffset:o.byte_offset(),byteStride:o.byte_stride(),normalized:o.normalized(),metadata:s},u=this._deduceAttributeName(c,n),l=this._getAttributeTypedArray(t,e,o,u).typedArray;r[u]={value:l,size:l.length/i,metadata:s}}return r}},{key:"_getMeshFaceIndices",value:function(t,e){for(var n=e.num_faces(),r=new Uint32Array(3*n),i=new this.draco.DracoInt32Array,a=0;a<n;++a){t.GetFaceFromMesh(e,a,i);var o=3*a;r[o]=i.GetValue(0),r[o+1]=i.GetValue(1),r[o+2]=i.GetValue(2)}return this.draco.destroy(i),r}},{key:"_getMeshStripIndices",value:function(t,e){var n=new this.draco.DracoInt32Array;t.GetTriangleStripsFromMesh(e,n);for(var r=new Uint32Array(n.size()),i=0;i<n.size();++i)r[i]=n.GetValue(i);return this.draco.destroy(n),r}},{key:"_getAttributeTypedArray",value:function(t,e,n,r){if(0===n.ptr){var i="DRACO decode bad attribute ".concat(r);throw new Error(i)}var a,o,s=rr[n.data_type()],c=n.num_components(),u=e.num_points()*c;switch(s){case Float32Array:a=new this.draco.DracoFloat32Array,t.GetAttributeFloatForAllPoints(e,n,a),o=new Float32Array(u);break;case Int8Array:a=new this.draco.DracoInt8Array,t.GetAttributeInt8ForAllPoints(e,n,a),o=new Int8Array(u);break;case Int16Array:a=new this.draco.DracoInt16Array,t.GetAttributeInt16ForAllPoints(e,n,a),o=new Int16Array(u);break;case Int32Array:a=new this.draco.DracoInt32Array,t.GetAttributeInt32ForAllPoints(e,n,a),o=new Int32Array(u);break;case Uint8Array:a=new this.draco.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(e,n,a),o=new Uint8Array(u);break;case Uint16Array:a=new this.draco.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(e,n,a),o=new Uint16Array(u);break;case Uint32Array:a=new this.draco.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(e,n,a),o=new Uint32Array(u);break;default:throw new Error("DRACO decoder: unexpected attribute type.")}for(var l=0;l<u;l++)o[l]=a.GetValue(l);return this.draco.destroy(a),{typedArray:o,components:c}}},{key:"_deduceAttributeName",value:function(t,e){var n=e.extraAttributes,r=void 0===n?{}:n;if(r&&"object"===Object(Xt.a)(r))for(var i=0,a=Object.entries(r);i<a.length;i++){var o=Object(C.a)(a[i],2),s=o[0];if(o[1]===t.uniqueId)return s}for(var c in nr){var u=this.draco[c];if(t.attributeType===u)return nr[c]}if(t.metadata){var l=e.attributeNameEntry||"name";if(t.metadata[l])return t.metadata[l].string}return"CUSTOM_ATTRIBUTE_".concat(t.uniqueId)}},{key:"_getGeometryMetadata",value:function(t,e){var n=t.GetMetadata(e);return this._queryDracoMetadata(n)}},{key:"_getAttributeMetadata",value:function(t,e,n){var r=t.GetAttributeMetadata(e,n);return this._queryDracoMetadata(r)}},{key:"_queryDracoMetadata",value:function(t){if(!t||!t.ptr)return{};for(var e={},n=this.metadataQuerier.NumEntries(t),r=0;r<n;r++){var i=this.metadataQuerier.GetEntryName(t,r);e[i]={int:this.metadataQuerier.GetIntEntry(t,i),string:this.metadataQuerier.GetStringEntry(t,i),double:this.metadataQuerier.GetDoubleEntry(t,i),intArray:this.metadataQuerier.GetIntEntryArray(t,i)}}return e}},{key:"decode",value:function(t,e){return this.parseSync(t,e)}}]),t}();function ar(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function or(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ar(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var sr=or(or({},{id:"draco",name:"Draco",version:"2.3.0",extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"===("undefined"==typeof WebAssembly?"undefined":Object(Xt.a)(WebAssembly))?"wasm":"js",libraryPath:"libs/",workerUrl:"https://unpkg.com/@loaders.gl/draco@".concat("2.3.0","/dist/draco-loader.worker.js"),localWorkerUrl:"modules/draco/dist/draco-loader.worker.dev.js",extraAttributes:{}}}}),{},{parse:function(t,e,n,r){return cr.apply(this,arguments)}});function cr(){return(cr=Object(An.a)(Sn.a.mark((function t(e,n,r,i){var a,o,s;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yn(n);case 2:return a=t.sent,o=a.draco,s=new ir(o),t.prev=5,t.abrupt("return",s.parseSync(e,or({extraAttributes:n.draco&&n.draco.extraAttributes||null},n.parseOptions||{})));case 7:return t.prev=7,s.destroy(),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[5,,7,10]])})))).apply(this,arguments)}function ur(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ur(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ur(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var hr,pr={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},fr=lr(lr({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6}),pr),dr=n("SDD5"),vr=(hr={},Object(h.a)(hr,pr.DOUBLE,Float64Array),Object(h.a)(hr,pr.FLOAT,Float32Array),Object(h.a)(hr,pr.UNSIGNED_SHORT,Uint16Array),Object(h.a)(hr,pr.UNSIGNED_INT,Uint32Array),Object(h.a)(hr,pr.UNSIGNED_BYTE,Uint8Array),Object(h.a)(hr,pr.BYTE,Int8Array),Object(h.a)(hr,pr.SHORT,Int16Array),Object(h.a)(hr,pr.INT,Int32Array),hr),yr={DOUBLE:pr.DOUBLE,FLOAT:pr.FLOAT,UNSIGNED_SHORT:pr.UNSIGNED_SHORT,UNSIGNED_INT:pr.UNSIGNED_INT,UNSIGNED_BYTE:pr.UNSIGNED_BYTE,BYTE:pr.BYTE,SHORT:pr.SHORT,INT:pr.INT},br=function(){function t(){Object(f.a)(this,t)}return Object(v.a)(t,null,[{key:"fromTypedArray",value:function(t){for(var e in t=ArrayBuffer.isView(t)?t.constructor:t,vr){if(vr[e]===t)return e}throw new Error("Failed to convert GL type")}},{key:"fromName",value:function(t){var e=yr[t];if(!e)throw new Error("Failed to convert GL type");return e}},{key:"getArrayType",value:function(t){switch(t){case pr.UNSIGNED_SHORT_5_6_5:case pr.UNSIGNED_SHORT_4_4_4_4:case pr.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var e=vr[t];if(!e)throw new Error("Failed to convert GL type");return e}}},{key:"getByteSize",value:function(e){return t.getArrayType(e).BYTES_PER_ELEMENT}},{key:"validate",value:function(e){return Boolean(t.getArrayType(e))}},{key:"createTypedArray",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;void 0===i&&(i=(n.byteLength-r)/t.getByteSize(e));var a=t.getArrayType(e);return new a(n,r,i)}}]),t}(),gr=function(){function t(e,n){Object(f.a)(this,t),this.json=e,this.buffer=n,this.featuresLength=0,this._cachedTypedArrays={}}return Object(v.a)(t,[{key:"getExtension",value:function(t){return this.json.extensions&&this.json.extensions[t]}},{key:"hasProperty",value:function(t){return Boolean(this.json[t])}},{key:"getGlobalProperty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fr.UNSIGNED_INT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r}},{key:"getPropertyArray",value:function(t,e,n){var r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=br.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)}},{key:"getProperty",value:function(t,e,n,r,i){var a=this.json[t];if(!a)return a;var o=this.getPropertyArray(t,e,n);if(1===n)return o[r];for(var s=0;s<n;++s)i[s]=o[n*r+s];return i}},{key:"_getTypedArrayFromBinary",value:function(t,e,n,r,i){var a=this._cachedTypedArrays,o=a[t];return o||(o=br.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),a[t]=o),o}},{key:"_getTypedArrayFromArray",value:function(t,e,n){var r=this._cachedTypedArrays,i=r[t];return i||(i=br.createTypedArray(e,n),r[t]=i),i}}]),t}(),mr=n("KQm4"),_r={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Or={SCALAR:function(t,e){return t[e]},VEC2:function(t,e){return[t[2*e+0],t[2*e+1]]},VEC3:function(t,e){return[t[3*e+0],t[3*e+1],t[3*e+2]]},VEC4:function(t,e){return[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]]},MAT2:function(t,e){return[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]]},MAT3:function(t,e){return[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]]},MAT4:function(t,e){return[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]}},jr={SCALAR:function(t,e,n){e[n]=t},VEC2:function(t,e,n){e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:function(t,e,n){e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:function(t,e,n){e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:function(t,e,n){e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:function(t,e,n){e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:function(t,e,n){e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};var wr=n("sfiq"),Er=function(t){return void 0!==t};function Tr(t,e,n){if(!e)return null;var r=t.getExtension("3DTILES_batch_table_hierarchy"),i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){var n,r,i,a,o=t.instancesLength,s=t.classes,c=t.classIds,u=t.parentCounts,l=t.parentIds,h=o;Er(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),Object(wr.a)("classIds"),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,o));if(Er(u))for(Er(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),Object(wr.a)("parentCounts"),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,o)),a=new Uint16Array(o),Object(wr.a)("parentIdsLength"),h=0,n=0;n<o;++n)a[n]=h,h+=(Object(wr.a)("parentIdsLength"),u[n]);Er(l)&&Er(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),Object(wr.a)("parentIds"),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,h));var p=s.length;for(n=0;n<p;++n){var f=s[n].length,d=s[n].instances,v=getBinaryProperties(f,d,e);s[n].instances=combine(v,d)}var y=new Array(p).fill(0),b=new Uint16Array(o);for(n=0;n<o;++n)r=c[n],b[n]=y[r],++y[r];var g={classes:s,classIds:c,classIndexes:b,parentCounts:u,parentIndexes:a,parentIds:l};return function(t){for(var e=t.classIds.length,n=0;n<e;++n)xr(t,n,stack)}(g),g}(r,n):null}function kr(t,e,n){if(t){var r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){var r=t.classIds,i=t.parentCounts,a=t.parentIds,o=t.parentIndexes,s=r.length,c=scratchVisited;c.length=Math.max(c.length,s);var u=++marker,l=scratchStack;l.length=0,l.push(e);for(;l.length>0;)if(e=l.pop(),c[e]!==u){c[e]=u;var h=n(t,e);if(Er(h))return h;for(var p=i[e],f=o[e],d=0;d<p;++d){var v=a[f+d];v!==e&&l.push(v)}}return null}(t,e,n):function(t,e,n){var r=!0;for(;r;){var i=n(t,e);if(Er(i))return i;var a=t.parentIds[e];r=a!==e,e=a}throw new Error("traverseHierarchySingleParent")}(t,e,n)}}function xr(t,e,n){var r=t.parentCounts,i=t.parentIds,a=t.parentIndexes,o=t.classIds.length;if(Er(i)){assert(e<o,"Parent index ".concat(e," exceeds the total number of instances: ").concat(o)),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);for(var s=Er(r)?r[e]:1,c=Er(r)?a[e]:e,u=0;u<s;++u){var l=i[c+u];l!==e&&xr(t,l,n)}n.pop(e)}}function Pr(t){return null!=t}var Sr=function(t,e){return t},Ar={HIERARCHY:!0,extensions:!0,extras:!0},Ir=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(var a in Object(f.a)(this,t),Object(Bn.a)(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=this.json&&this.json.extensions||{},this._properties={},this.json)Ar[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Tr(this,this.json,this.binary))}return Object(v.a)(t,[{key:"getExtension",value:function(t){return this.json&&this.json.extensions&&this.json.extensions[t]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(t,e){return this._checkBatchId(t),Object(Bn.a)("string"==typeof e,e),!!this._hierarchy&&Pr(kr(this._hierarchy,t,(function(t,n){var r=t.classIds[n];return t.classes[r].name===e})))}},{key:"isExactClass",value:function(t,e){return Object(Bn.a)("string"==typeof e,e),this.getExactClassName(t)===e}},{key:"getExactClassName",value:function(t){if(this._checkBatchId(t),this._hierarchy){var e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}},{key:"hasProperty",value:function(t,e){return this._checkBatchId(t),Object(Bn.a)("string"==typeof e,e),Pr(this._properties[e])||this._hasPropertyInHierarchy(t,e)}},{key:"getPropertyNames",value:function(t,e){var n;this._checkBatchId(t),(e=Pr(e)?e:[]).length=0;var r=Object.keys(this._properties);return(n=e).push.apply(n,Object(mr.a)(r)),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}},{key:"getProperty",value:function(t,e){if(this._checkBatchId(t),Object(Bn.a)("string"==typeof e,e),this._binaryProperties){var n=this._binaryProperties[e];if(Pr(n))return this._getBinaryProperty(n,t)}var r=this._properties[e];if(Pr(r))return Sr(r[t]);if(this._hierarchy){var i=this._getHierarchyProperty(t,e);if(Pr(i))return i}}},{key:"setProperty",value:function(t,e,n){var r=this.featureCount;if(this._checkBatchId(t),Object(Bn.a)("string"==typeof e,e),this._binaryProperties){var i=this._binaryProperties[e];if(i)return void this._setBinaryProperty(i,t,n)}if(!this._hierarchy||!this._setHierarchyProperty(this,t,e,n)){var a=this._properties[e];Pr(a)||(this._properties[e]=new Array(r),a=this._properties[e]),a[t]=Sr(n)}}},{key:"_checkBatchId",value:function(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}},{key:"_getBinaryProperty",value:function(t,e){return t.unpack(t.typedArray,e)}},{key:"_setBinaryProperty",value:function(t,e,n){t.pack(n,t.typedArray,e)}},{key:"_initializeBinaryProperties",value:function(){var t=null;for(var e in this._properties){var n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&((t=t||{})[e]=r)}return t}},{key:"_initializeBinaryProperty",value:function(t,e){if("byteOffset"in e){var n=e;Object(Bn.a)(this.binary,"Property ".concat(t," requires a batch table binary.")),Object(Bn.a)(n.type,"Property ".concat(t," requires a type."));var r=function(t,e,n,r){var i=t.componentType;Object(Bn.a)(t.componentType);var a="string"==typeof i?br.fromName(i):i,o=_r[t.type],s=Or[t.type],c=jr[t.type];return n+=t.byteOffset,{values:br.createTypedArray(a,e,n,o*r),type:a,size:o,unpacker:s,packer:c}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}},{key:"_hasPropertyInHierarchy",value:function(t,e){if(!this._hierarchy)return!1;var n=kr(this._hierarchy,t,(function(t,n){var r=t.classIds[n];return Pr(t.classes[r].instances[e])}));return Pr(n)}},{key:"_getPropertyNamesInHierarchy",value:function(t,e){kr(this._hierarchy,t,(function(t,n){var r=t.classIds[n],i=t.classes[r].instances;for(var a in i)i.hasOwnProperty(a)&&-1===e.indexOf(a)&&e.push(a)}))}},{key:"_getHierarchyProperty",value:function(t,e){var n=this;return kr(this._hierarchy,t,(function(t,r){var i=t.classIds[r],a=t.classes[i],o=t.classIndexes[r],s=a.instances[e];return Pr(s)?Pr(s.typedArray)?n._getBinaryProperty(s,o):Sr(s[o]):null}))}},{key:"_setHierarchyProperty",value:function(t,e,n,r){var i=this,a=kr(this._hierarchy,e,(function(t,a){var o=t.classIds[a],s=t.classes[o],c=t.classIndexes[a],u=s.instances[n];return!!Pr(u)&&(Object(Bn.a)(a===e,'Inherited property "'.concat(n,'" is read-only.')),Pr(u.typedArray)?i._setBinaryProperty(u,c,r):u[c]=Sr(r),!0)}));return Pr(a)}}]),t}();function Cr(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=4,t.version=r.getUint32(n,!0),n+=4,t.byteLength=r.getUint32(n,!0),n+=4,1!==t.version)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}function Rr(t,e,n){var r=new DataView(e);return t.header=t.header||{},t.header.featureTableJsonByteLength=r.getUint32(n,!0),n+=4,t.header.featureTableBinaryByteLength=r.getUint32(n,!0),n+=4,t.header.batchTableJsonByteLength=r.getUint32(n,!0),n+=4,t.header.batchTableBinaryByteLength=r.getUint32(n,!0),n+=4}function Dr(t,e,n,r){return n=function(t,e,n,r){var i=t.header,a=i.featureTableJsonByteLength,o=i.featureTableBinaryByteLength;if(t.featureTableJson={BATCH_LENGTH:0},a>0){var s=Fn(e,n,a);t.featureTableJson=JSON.parse(s)}return n+=a,t.featureTableBinary=new Uint8Array(e,n,o),n+=o}(t,e,n),n=function(t,e,n,r){var i=t.header,a=i.batchTableJsonByteLength,o=i.batchTableBinaryByteLength;if(a>0){var s=Fn(e,n,a);t.batchTableJson=JSON.parse(s),n+=a,o>0&&(t.batchTableBinary=new Uint8Array(e,n,o),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=o)}return n}(t,e,n)}function Lr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function Nr(t,e,n){if(!(e||t&&t.batchIds&&n))return null;var r=t.batchIds,i=t.isRGB565,a=t.pointCount;if(r&&n){for(var o=new Uint8ClampedArray(3*a),s=0;s<a;s++){var c=r[s],u=n.getProperty(c,"dimensions").map((function(t){return 255*t}));o[3*s]=u[0],o[3*s+1]=u[1],o[3*s+2]=u[2]}return{type:fr.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){for(var l=new Uint8ClampedArray(3*a),h=0;h<a;h++){var p=Lr(e[h]);l[3*h]=p[0],l[3*h+1]=p[1],l[3*h+2]=p[2]}return{type:fr.UNSIGNED_BYTE,value:l,size:3,normalized:!0}}return e&&e.length===3*a?{type:fr.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:fr.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var Mr=n("uJc0"),zr=n("yeNo");n("V6u+");function Ur(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}new Mr.a,new dr.a,new Mr.a,new Mr.a,new Uint8Array(1);function Br(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return Object(zr.a)(t,0,e)/e*2-1}function Fr(t){return t<0?-1:1}function Vr(t,e,n,r){if(Ur(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=Br(t,n),r.y=Br(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){var i=r.x;r.x=(1-Math.abs(r.y))*Fr(i),r.y=(1-Math.abs(i))*Fr(r.y)}return r.normalize()}function Gr(t,e,n){return Vr(t,e,255,n)}var Hr=new dr.a;function qr(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){for(var n=new dr.a,r=new Float32Array(3*t.pointCount),i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:fr.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function Zr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Wr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zr(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Yr(t,e,n,r,i){return Xr.apply(this,arguments)}function Xr(){return(Xr=Object(An.a)(Sn.a.mark((function t(e,n,r,i,a){var o,s,c;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Cr(e,n,r),r=Rr(e,n,r),r=Dr(e,n,r),Jr(e),o=Kr(e),s=o.featureTable,c=o.batchTable,t.next=7,ei(e,s,c,i,a);case 7:return Qr(e,s,i),$r(e,s,c),ti(e,s),t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jr(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function Kr(t){var e=new gr(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",fr.FLOAT,3);var r=function(t,e){var n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",fr.UNSIGNED_SHORT,1),t.batchIds)){var r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=t.batchTableJson,a=t.batchTableBinary;n=new Ir(i,a,r)}return n}(t,e);return{featureTable:e,batchTable:r}}function Qr(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",fr.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){var r=e.getPropertyArray("POSITION_QUANTIZED",fr.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",fr.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",fr.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=qr(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function $r(t,e,n){if(!t.attributes.colors){var r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",fr.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",fr.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",fr.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=Nr(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",fr.UNSIGNED_BYTE,4))}function ti(t,e){if(!t.attributes.normals){var n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",fr.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",fr.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){for(var n=new Float32Array(3*t.pointsLength),r=0;r<t.pointsLength;r++)Gr(e[2*r],e[2*r+1],Hr),Hr.toArray(n,3*r);return{type:fr.FLOAT,size:2,value:n}}return{type:fr.FLOAT,size:2,value:e}}(t,n)}}function ei(t,e,n,r,i){return ni.apply(this,arguments)}function ni(){return(ni=Object(An.a)(Sn.a.mark((function t(e,n,r,i,a){var o,s,c,u,l,h,p,f;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((u=e.batchTableJson&&e.batchTableJson.extensions&&e.batchTableJson.extensions["3DTILES_draco_point_compression"])&&(c=u.properties),!(l=n.getExtension("3DTILES_draco_point_compression"))){t.next=15;break}if(s=l.properties,h=l.byteOffset,p=l.byteLength,s&&Number.isFinite(h)&&p){t.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:o=e.featureTableBinary.slice(h,h+p),e.hasPositions=Number.isFinite(s.POSITION),e.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),e.hasNormals=Number.isFinite(s.NORMAL),e.hasBatchIds=Number.isFinite(s.BATCH_ID),e.isTranslucent=Number.isFinite(s.RGBA);case 15:if(o){t.next=17;break}return t.abrupt("return",!0);case 17:return f={buffer:o,properties:Wr(Wr({},s),c),featureTableProperties:s,batchTableProperties:c,dequantizeInShader:!1},t.next=20,ri(e,f,i,a);case 20:return t.abrupt("return",t.sent);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ri(t,e,n,r){return ii.apply(this,arguments)}function ii(){return(ii=Object(An.a)(Sn.a.mark((function t(e,n,r,i){var a,o,s,c,u,l,h,p,f,d,v,y,b,g;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.parse,t.next=3,a(n.buffer,sr,{draco:{extraAttributes:n.batchTableProperties||{}}});case 3:if(o=t.sent,s=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,u=o.attributes.NORMAL&&o.attributes.NORMAL.value,l=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,h=s&&o.attributes.POSITION.value.quantization,p=u&&o.attributes.NORMAL.value.quantization,h&&(f=o.POSITION.data.quantization,d=f.range,e.quantizedVolumeScale=new dr.a(d,d,d),e.quantizedVolumeOffset=new dr.a(f.minValues),e.quantizedRange=(1<<f.quantizationBits)-1,e.isQuantizedDraco=!0),p&&(e.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0),v={},n.batchTableProperties)for(y=0,b=Object.keys(n.batchTableProperties);y<b.length;y++)g=b[y],o.attributes[g]&&o.attributes[g].value&&(v[g.toLowerCase()]=o.attributes[g].value);e.attributes=Wr({positions:s,colors:Nr(e,c),normals:u,batchIds:l},v);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ai=n("kEPd"),oi=n("sx9D"),si=n("h5Ug");function ci(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function ui(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;var n=e.baseUri||e.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return n.substr(0,n.lastIndexOf("/")+1)+t}function li(t,e,n){var r=t.bufferViews[n];ci(r);var i=e[r.buffer];ci(i);var a=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,a,r.byteLength)}var hi=n("YkLe"),pi=["SCALAR","VEC2","VEC3","VEC4"],fi=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),di={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},vi={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},yi={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function bi(t){return pi[t-1]||pi[0]}function gi(t){var e=fi.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function mi(t,e){var n=yi[t.componentType],r=di[t.type],i=vi[t.componentType],a=t.count*r,o=t.count*r*i;return ci(o>=0&&o<=e.byteLength),{ArrayType:n,length:a,byteLength:o}}var _i=function(){function t(e){if(Object(f.a)(this,t),e instanceof t)return e;e||(e={json:{asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},buffers:[]}),this.byteLength=0,this.gltf=e,ci(this.gltf.json)}return Object(v.a)(t,[{key:"getApplicationData",value:function(t){return this.json[t]}},{key:"getExtraData",value:function(t){return(this.json.extras||{})[t]}},{key:"getExtension",value:function(t){var e=this.getUsedExtensions().find((function(e){return e===t})),n=this.json.extensions||{};return e?n[t]||!0:null}},{key:"getRequiredExtension",value:function(t){return this.getRequiredExtensions().find((function(e){return e===t}))?this.getExtension(t):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(t,e){return(t.extensions||{})[e]}},{key:"getScene",value:function(t){return this.getObject("scenes",t)}},{key:"getNode",value:function(t){return this.getObject("nodes",t)}},{key:"getSkin",value:function(t){return this.getObject("skins",t)}},{key:"getMesh",value:function(t){return this.getObject("meshes",t)}},{key:"getMaterial",value:function(t){return this.getObject("materials",t)}},{key:"getAccessor",value:function(t){return this.getObject("accessors",t)}},{key:"getCamera",value:function(t){return null}},{key:"getTexture",value:function(t){return this.getObject("textures",t)}},{key:"getSampler",value:function(t){return this.getObject("samplers",t)}},{key:"getImage",value:function(t){return this.getObject("images",t)}},{key:"getBufferView",value:function(t){return this.getObject("bufferViews",t)}},{key:"getBuffer",value:function(t){return this.getObject("buffers",t)}},{key:"getObject",value:function(t,e){if("object"===Object(Xt.a)(e))return e;var n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}},{key:"getTypedArrayForBufferView",value:function(t){var e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];ci(n);var r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}},{key:"getTypedArrayForAccessor",value:function(t){t=this.getAccessor(t);var e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=mi(t,e),i=r.ArrayType,a=r.length;return new i(n,e.byteOffset+t.byteOffset,a)}},{key:"getTypedArrayForImageData",value:function(t){t=this.getAccessor(t);var e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}},{key:"addApplicationData",value:function(t,e){return this.json[t]=e,this}},{key:"addExtraData",value:function(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}},{key:"addObjectExtension",value:function(t,e,n){return ci(n),t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}},{key:"setObjectExtension",value:function(t,e,n){(t.extensions||{})[e]=n}},{key:"removeObjectExtension",value:function(t,e){var n=t.extensions||{},r=n[e];return delete n[e],r}},{key:"addExtension",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ci(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}},{key:"addRequiredExtension",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ci(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}},{key:"registerUsedExtension",value:function(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(e){return e===t}))||this.json.extensionsUsed.push(t)}},{key:"registerRequiredExtension",value:function(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(e){return e===t}))||this.json.extensionsRequired.push(t)}},{key:"removeExtension",value:function(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}},{key:"addMesh",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=this._addAttributes(t),i={primitives:[{attributes:r,indices:e,mode:n}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}},{key:"addPointCloud",value:function(t){var e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}},{key:"addImage",value:function(t,e){e=e||Object(hi.a)(t);var n={bufferView:this.addBufferView(t),mimeType:e};return this.json.images=this.json.images||[],this.json.images.push(n),this.json.images.length-1}},{key:"addBufferView",value:function(t){var e=t.byteLength;ci(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);var n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=Object(si.c)(e),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(t,e){var n={bufferView:t,type:bi(e.size),componentType:e.componentType,count:e.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},n=this.addBufferView(t),r={size:e.size,componentType:gi(t),count:Math.round(t.length/e.size)};return this.addAccessor(n,Object.assign(r,e))}},{key:"createBinaryChunk",value:function(){if(!this.arrayBuffer){for(var t=this.byteLength,e=new ArrayBuffer(t),n=new Uint8Array(e),r=0,i=0;i<this.sourceBuffers.length;i++){var a=this.sourceBuffers[i];r=Object(si.a)(a,n,r)}this.json.buffers[0].byteLength=t,this.arrayBuffer=e,this.sourceBuffers=[]}}},{key:"_removeStringFromArray",value:function(t,e){for(var n=!0;n;){var r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}},{key:"json",get:function(){return this.gltf.json}}]),t}();function Oi(t){var e={};for(var n in t){var r=t[n];if("indices"!==n){var i=ji(r);e[n]=i}}return e}function ji(t,e){var n=function(t,e){var n=t,r=1,i=0;t&&t.value&&(n=t.value,r=t.size||1);n&&(ArrayBuffer.isView(n)||(n=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return null;if(Array.isArray(t))return new e(t);if(n&&!(t instanceof e))return new e(t);return t}(n,Float32Array)),i=n.length/r);return{buffer:n,size:r,count:i}}(t),r=n.buffer,i=n.size;return{value:r,size:i,bufferView:null,byteOffset:0,count:n.count,type:bi(i),componentType:gi(r)}}var wi=Sn.a.mark(Ri);function Ei(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ti(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ti(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ti(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ki(t,e,n){return xi.apply(this,arguments)}function xi(){return(xi=Object(An.a)(Sn.a.mark((function t(e,n,r){var i,a,o,s,c;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.gltf.decompressMeshes){t.next=2;break}return t.abrupt("return");case 2:i=new _i(e),a=[],o=Ei(Ri(i));try{for(o.s();!(s=o.n()).done;)c=s.value,i.getObjectExtension(c,"KHR_draco_mesh_compression")&&a.push(Si(c,i,n,r))}catch(u){o.e(u)}finally{o.f()}return t.next=8,Promise.all(a);case 8:i.removeExtension("KHR_draco_mesh_compression");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Pi(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new _i(t),i=Ei(r.json.meshes||[]);try{for(i.s();!(e=i.n()).done;){var a=e.value;Ii(a,n),r.addRequiredExtension("KHR_draco_mesh_compression")}}catch(o){i.e(o)}finally{i.f()}}function Si(t,e,n,r){return Ai.apply(this,arguments)}function Ai(){return(Ai=Object(An.a)(Sn.a.mark((function t(e,n,r,i){var a,o,s,c,u;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.getObjectExtension(e,"KHR_draco_mesh_compression"),o=n.getTypedArrayForBufferView(a.bufferView),s=Object(si.b)(o.buffer,o.byteOffset),c=i.parse,t.next=6,c(s,sr,r,i);case 6:u=t.sent,e.attributes=Oi(u.attributes),u.indices&&(e.indices=ji(u.indices)),Ci(e);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ii(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!r.DracoWriter||!r.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var a=r.DracoWriter.encodeSync({attributes:t}),o=i.parseSync,s=o({attributes:t}),c=r._addFauxAttributes(s.attributes),u=r.addBufferView(a),l={primitives:[{attributes:c,mode:n,extensions:Object(h.a)({},"KHR_draco_mesh_compression",{bufferView:u,attributes:c})}]};return l}function Ci(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function Ri(t){var e,n,r,i,a,o;return Sn.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=Ei(t.json.meshes||[]),s.prev=1,e.s();case 3:if((n=e.n()).done){s.next=24;break}r=n.value,i=Ei(r.primitives),s.prev=6,i.s();case 8:if((a=i.n()).done){s.next=14;break}return o=a.value,s.next=12,o;case 12:s.next=8;break;case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(6),i.e(s.t0);case 19:return s.prev=19,i.f(),s.finish(19);case 22:s.next=3;break;case 24:s.next=29;break;case 26:s.prev=26,s.t1=s.catch(1),e.e(s.t1);case 29:return s.prev=29,e.f(),s.finish(29);case 32:case"end":return s.stop()}}),wi,null,[[1,26,29,32],[6,16,19,22]])}function Di(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Li(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Li(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ni(t,e){var n=new _i(t),r=n.json,i=n.getExtension("KHR_lights_punctual");i&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual"));var a,o=Di(r.nodes||[]);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=n.getObjectExtension(s,"KHR_lights_punctual");c&&(s.light=c.light),n.removeObjectExtension(s,"KHR_lights_punctual")}}catch(u){o.e(u)}finally{o.f()}}function Mi(t,e){var n=new _i(t),r=n.json;if(r.lights){var i=n.addExtension("KHR_lights_punctual");ci(!i.lights),i.lights=r.lights,delete r.lights}if(n.json.lights){var a,o=Di(n.json.lights);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=s.node;n.addObjectExtension(c,"KHR_lights_punctual",s)}}catch(u){o.e(u)}finally{o.f()}delete n.json.lights}}function zi(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ui(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ui(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Bi(t,e){var n=new _i(t),r=n.json;n.removeExtension("KHR_materials_unlit");var i,a=zi(r.materials||[]);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.extensions&&o.extensions.KHR_materials_unlit&&(o.unlit=!0),n.removeObjectExtension(o,"KHR_materials_unlit")}}catch(s){a.e(s)}finally{a.f()}}function Fi(t,e){var n=new _i(t),r=n.json;if(n.materials){var i,a=zi(r.materials);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.unlit&&(delete o.unlit,n.addObjectExtension(o,"KHR_materials_unlit",{}),n.addExtension("KHR_materials_unlit"))}}catch(s){a.e(s)}finally{a.f()}}}function Vi(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Gi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gi(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Gi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Hi(t,e){var n=new _i(t),r=n.json,i=n.getExtension("KHR_techniques_webgl");if(i){var a,o=function(t,e){var n=t.programs,r=void 0===n?[]:n,i=t.shaders,a=void 0===i?[]:i,o=t.techniques,s=void 0===o?[]:o,c=new TextDecoder;return a.forEach((function(t){if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=c.decode(e.getTypedArrayForBufferView(t.bufferView))})),r.forEach((function(t){t.fragmentShader=a[t.fragmentShader],t.vertexShader=a[t.vertexShader]})),s.forEach((function(t){t.program=r[t.program]})),s}(i,n),s=Vi(r.materials||[]);try{for(s.s();!(a=s.n()).done;){var c=a.value,u=n.getObjectExtension(c,"KHR_techniques_webgl");u&&(c.technique=Object.assign({},u,o[u.technique]),c.technique.values=Zi(c.technique,n)),n.removeObjectExtension(c,"KHR_techniques_webgl")}}catch(l){s.e(l)}finally{s.f()}n.removeExtension("KHR_techniques_webgl")}}function qi(t,e){}function Zi(t,e){var n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((function(e){t.uniforms[e].value&&!(e in n)&&(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((function(t){"object"===Object(Xt.a)(n[t])&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}var Wi={KHR_draco_mesh_compression:r,KHR_lights_punctual:i,KHR_materials_unlit:a,KHR_techniques_webgl:o};function Yi(t){return Xi.apply(this,arguments)}function Xi(){return(Xi=Object(An.a)(Sn.a.mark((function t(e){var n,r,i,a,o,s=arguments;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2?s[2]:void 0,n.gltf=n.gltf||{},t.t0=Sn.a.keys(Wi);case 4:if((t.t1=t.t0()).done){t.next=14;break}if(i=t.t1.value,a=n.gltf.excludeExtensions||{},i in a&&!a[i]){t.next=12;break}return o=Wi[i],t.next=12,o.decode(e,n,r);case 12:t.next=4;break;case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ji(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function Ki(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new DataView(t),i=n.magic,a=void 0===i?1735152710:i,o=r.getUint32(e,!1);return o===a||1735152710===o}function Qi(t,e,n,r){Object(Bn.a)(t.header.byteLength>20);var i=e.getUint32(n+0,!0),a=e.getUint32(n+4,!0);return n+=8,Object(Bn.a)(0===a),ta(t,e,n,i,r),n+=i,n+=ea(t,e,n,t.header.byteLength,r)}function $i(t,e,n,r){return Object(Bn.a)(t.header.byteLength>20),function(t,e,n,r){for(;n+8<=t.header.byteLength;){var i=e.getUint32(n+0,!0),a=e.getUint32(n+4,!0);switch(n+=8,a){case 1313821514:ta(t,e,n,i,r);break;case 5130562:ea(t,e,n,i,r);break;case 0:r.glb.strict||ta(t,e,n,i,r);break;case 1:r.glb.strict||ea(t,e,n,i,r)}n+=Object(si.c)(i)}}(t,e,n,r),n+t.header.byteLength}function ta(t,e,n,r,i){var a=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(a);return t.json=JSON.parse(o),Object(si.c)(r)}function ea(t,e,n,r,i){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),Object(si.c)(r)}function na(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ra(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ra(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ra(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ia(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return aa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aa(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function aa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var oa,sa={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},ca={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},ua=function(){function t(e){Object(f.a)(this,t),this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}return Object(v.a)(t,[{key:"normalize",value:function(t,e){this.json=t.json;var n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(n.asset.version))}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t,e){var n,r=new _i(t),i=r.json,a=na(i.images||[]);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.removeObjectExtension(o,"KHR_binary_glTF");s&&Object.assign(o,s)}}catch(c){a.e(c)}finally{a.f()}i.buffers&&i.buffers[0]&&delete i.buffers[0].uri,r.removeExtension("KHR_binary_glTF")}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n)}},{key:"_addAsset",value:function(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(t){for(var e in sa)this._convertTopLevelObjectToArray(t,e)}},{key:"_convertTopLevelObjectToArray",value:function(t,e){var n=t[e];if(n&&!Array.isArray(n))for(var r in t[e]=[],n){var i=n[r];i.id=i.id||r;var a=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=a}}},{key:"_convertObjectIdsToArrayIndices",value:function(t){for(var e in sa)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));var n,r=ia(t.textures);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._convertTextureIds(i)}}catch(d){r.e(d)}finally{r.f()}var a,o=ia(t.meshes);try{for(o.s();!(a=o.n()).done;){var s=a.value;this._convertMeshIds(s)}}catch(d){o.e(d)}finally{o.f()}var c,u=ia(t.nodes);try{for(u.s();!(c=u.n()).done;){var l=c.value;this._convertNodeIds(l)}}catch(d){u.e(d)}finally{u.f()}var h,p=ia(t.scenes);try{for(p.s();!(h=p.n()).done;){var f=h.value;this._convertSceneIds(f)}}catch(d){p.e(d)}finally{p.f()}}},{key:"_convertTextureIds",value:function(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}},{key:"_convertMeshIds",value:function(t){var e,n=ia(t.primitives);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.attributes,a=r.indices,o=r.material;for(var s in i)i[s]=this._convertIdToIndex(i[s],"accessor");a&&(r.indices=this._convertIdToIndex(a,"accessor")),o&&(r.material=this._convertIdToIndex(o,"material"))}}catch(c){n.e(c)}finally{n.f()}}},{key:"_convertNodeIds",value:function(t){var e=this;t.children&&(t.children=t.children.map((function(t){return e._convertIdToIndex(t,"node")})))}},{key:"_convertSceneIds",value:function(t){var e=this;t.nodes&&(t.nodes=t.nodes.map((function(t){return e._convertIdToIndex(t,"node")})))}},{key:"_convertIdsToIndices",value:function(t,e){var n,r=ia(t[e]);try{for(r.s();!(n=r.n()).done;){var i=n.value;for(var a in i){var o=i[a],s=this._convertIdToIndex(o,a);i[a]=s}}}catch(c){r.e(c)}finally{r.f()}}},{key:"_convertIdToIndex",value:function(t,e){var n=ca[e];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return r}return t}},{key:"_updateObjects",value:function(t){var e,n=ia(this.json.buffers);try{for(n.s();!(e=n.n()).done;){delete e.value.type}}catch(r){n.e(r)}finally{n.f()}}}]),t}();function la(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new ua).normalize(t,e)}function ha(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ha(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ha(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fa={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},da={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},va={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},ya={magFilter:va.TEXTURE_MAG_FILTER,minFilter:va.TEXTURE_MIN_FILTER,wrapS:va.TEXTURE_WRAP_S,wrapT:va.TEXTURE_WRAP_T},ba=(oa={},Object(h.a)(oa,va.TEXTURE_MAG_FILTER,va.LINEAR),Object(h.a)(oa,va.TEXTURE_MIN_FILTER,va.NEAREST_MIPMAP_LINEAR),Object(h.a)(oa,va.TEXTURE_WRAP_S,va.REPEAT),Object(h.a)(oa,va.TEXTURE_WRAP_,va.REPEAT),oa);var ga=function(){function t(){Object(f.a)(this,t)}return Object(v.a)(t,[{key:"postProcess",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.json,r=t.buffers,i=void 0===r?[]:r,a=t.images,o=void 0===a?[]:a,s=t.baseUri,c=void 0===s?"":s;return ci(n),this.baseUri=c,this.json=n,this.buffers=i,this.images=o,this._resolveTree(this.json,e),this.json}},{key:"_resolveTree",value:function(t){var e=this;t.bufferViews&&(t.bufferViews=t.bufferViews.map((function(t,n){return e._resolveBufferView(t,n)}))),t.images&&(t.images=t.images.map((function(t,n){return e._resolveImage(t,n)}))),t.samplers&&(t.samplers=t.samplers.map((function(t,n){return e._resolveSampler(t,n)}))),t.textures&&(t.textures=t.textures.map((function(t,n){return e._resolveTexture(t,n)}))),t.accessors&&(t.accessors=t.accessors.map((function(t,n){return e._resolveAccessor(t,n)}))),t.materials&&(t.materials=t.materials.map((function(t,n){return e._resolveMaterial(t,n)}))),t.meshes&&(t.meshes=t.meshes.map((function(t,n){return e._resolveMesh(t,n)}))),t.nodes&&(t.nodes=t.nodes.map((function(t,n){return e._resolveNode(t,n)}))),t.skins&&(t.skins=t.skins.map((function(t,n){return e._resolveSkin(t,n)}))),t.scenes&&(t.scenes=t.scenes.map((function(t,n){return e._resolveScene(t,n)}))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}},{key:"getScene",value:function(t){return this._get("scenes",t)}},{key:"getNode",value:function(t){return this._get("nodes",t)}},{key:"getSkin",value:function(t){return this._get("skins",t)}},{key:"getMesh",value:function(t){return this._get("meshes",t)}},{key:"getMaterial",value:function(t){return this._get("materials",t)}},{key:"getAccessor",value:function(t){return this._get("accessors",t)}},{key:"getCamera",value:function(t){return null}},{key:"getTexture",value:function(t){return this._get("textures",t)}},{key:"getSampler",value:function(t){return this._get("samplers",t)}},{key:"getImage",value:function(t){return this._get("images",t)}},{key:"getBufferView",value:function(t){return this._get("bufferViews",t)}},{key:"getBuffer",value:function(t){return this._get("buffers",t)}},{key:"_get",value:function(t,e){if("object"===Object(Xt.a)(e))return e;var n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}},{key:"_resolveScene",value:function(t,e){var n=this;return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map((function(t){return n.getNode(t)})),t}},{key:"_resolveNode",value:function(t,e){var n=this;return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map((function(t){return n.getNode(t)}))),void 0!==t.mesh&&(t.mesh=this.getMesh(t.mesh)),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}},{key:"_resolveSkin",value:function(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}},{key:"_resolveMesh",value:function(t,e){var n=this;return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map((function(t){var e=(t=pa({},t)).attributes;for(var r in t.attributes={},e)t.attributes[r]=n.getAccessor(e[r]);return void 0!==t.indices&&(t.indices=n.getAccessor(t.indices)),void 0!==t.material&&(t.material=n.getMaterial(t.material)),t}))),t}},{key:"_resolveMaterial",value:function(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture=pa({},t.normalTexture),t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture=pa({},t.occlustionTexture),t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture=pa({},t.emmisiveTexture),t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.pbrMetallicRoughness){t.pbrMetallicRoughness=pa({},t.pbrMetallicRoughness);var n=t.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=pa({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=pa({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return t}},{key:"_resolveAccessor",value:function(t,e){var n,r;if(t.id=t.id||"accessor-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,da[n]),t.components=(r=t.type,fa[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){var i=t.bufferView.buffer,a=mi(t,t.bufferView),o=a.ArrayType,s=a.length,c=(t.bufferView.byteOffset||0)+i.byteOffset;t.value=new o(i.arrayBuffer,c,s)}return t}},{key:"_resolveTexture",value:function(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):ba,t.source=this.getImage(t.source),t}},{key:"_resolveSampler",value:function(t,e){for(var n in t.id=t.id||"sampler-".concat(e),t.parameters={},t){var r=this._enumSamplerParameter(n);void 0!==r&&(t.parameters[r]=t[n])}return t}},{key:"_enumSamplerParameter",value:function(t){return ya[t]}},{key:"_resolveImage",value:function(t,e){t.id=t.id||"image-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));var n=this.images[e];return n&&(t.image=n),t}},{key:"_resolveBufferView",value:function(t,e){t.id=t.id||"bufferView-".concat(e);var n=t.buffer;t.buffer=this.buffers[n];var r=this.buffers[n].arrayBuffer,i=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(i+=t.byteOffset),t.data=new Uint8Array(r,i,t.byteLength),t}},{key:"_resolveCamera",value:function(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}]),t}();function ma(t,e){return(new ga).postProcess(t,e)}function _a(t,e){return Oa.apply(this,arguments)}function Oa(){return(Oa=Object(An.a)(Sn.a.mark((function t(e,n){var r,i,a,o,s,c,u=arguments;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:0,i=u.length>3?u[3]:void 0,a=u.length>4?u[4]:void 0,ja(e,n,r,i),la(e,{normalize:i.gltf.normalize}),o=[],i.gltf.loadImages&&(s=Ta(e,i,a),o.push(s)),!i.gltf.loadBuffers){t.next=10;break}return t.next=10,wa(e,i,a);case 10:return c=Yi(e,i,a),o.push(c),t.next=14,Promise.all(o);case 14:return t.abrupt("return",i.gltf.postProcess?ma(e,i):e);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ja(t,e,n,r){(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!Ki(e,n,r))&&(e=(new TextDecoder).decode(e));if("string"==typeof e)t.json=Object(oi.a)(e);else if(e instanceof ArrayBuffer){var i={};n=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new DataView(e);t.type=Ji(r,n+0),t.version=r.getUint32(n+4,!0);var i=r.getUint32(n+8,!0);switch(t.header={byteOffset:n,byteLength:i},t.json={},t.binChunks=[],n+=12,t.version){case 1:return Qi(t,r,n,{});case 2:return $i(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}(i,e,n,r),ci("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),t._glb=i,t.json=i.json}else ci(!1,"GLTF: must be ArrayBuffer or string");var a=t.json.buffers||[];if(t.buffers=new Array(a.length).fill(null),t._glb&&t._glb.header.hasBinChunk){var o=t._glb.binChunks;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}var s=t.json.images||[];t.images=new Array(s.length).fill({})}function wa(t,e,n){return Ea.apply(this,arguments)}function Ea(){return(Ea=Object(An.a)(Sn.a.mark((function t(e,n,r){var i,a,o,s,c,u;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0;case 1:if(!(i<e.json.buffers.length)){t.next=18;break}if(!(a=e.json.buffers[i]).uri){t.next=15;break}return ci(o=r.fetch),s=ui(a.uri,n),t.next=9,o(s);case 9:return c=t.sent,t.next=12,c.arrayBuffer();case 12:u=t.sent,e.buffers[i]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete a.uri;case 15:++i,t.next=1;break;case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ta(t,e,n){return ka.apply(this,arguments)}function ka(){return(ka=Object(An.a)(Sn.a.mark((function t(e,n,r){var i,a,o;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=e.json.images||[],a=[],o=0;o<i.length;++o)a.push(xa(e,i[o],o,n,r));return t.next=5,Promise.all(a);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xa(t,e,n,r,i){return Pa.apply(this,arguments)}function Pa(){return(Pa=Object(An.a)(Sn.a.mark((function t(e,n,r,i,a){var o,s,c,u,l,h,p;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a.fetch,s=a.parse,!n.uri){t.next=9;break}return u=ui(n.uri,i),t.next=5,o(u);case 5:return l=t.sent,t.next=8,l.arrayBuffer();case 8:c=t.sent;case 9:return Number.isFinite(n.bufferView)&&(h=li(e.json,e.buffers,n.bufferView),c=Object(si.b)(h.buffer,h.byteOffset,h.byteLength)),ci(c,"glTF image has no data"),t.next=13,s(c,ai.a,{},a);case 13:p=t.sent,e.images[r]=p;case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Sa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Aa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sa(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ia={id:"gltf",name:"glTF",version:"2.3.0",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(t){return Ra.apply(this,arguments)},options:{gltf:{normalize:!1,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},uri:"",log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}},Ca=Ia;function Ra(){return(Ra=Object(An.a)(Sn.a.mark((function t(e){var n,r,i,a,o,s=arguments;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2?s[2]:void 0,(n=Aa(Aa({},Ia.options),n)).gltf=Aa(Aa({},Ia.options.gltf),n.gltf),Da(n),i=n.byteOffset,a=void 0===i?0:i,o={},t.next=9,_a(o,e,a,n,r);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Da(t){"fetchImages"in t&&(t.gltf.loadImages=t.fetchImages),"createImages"in t&&(t.gltf.loadImages=t.createImages),"fetchLinkedResources"in t&&(t.gltf.fetchBuffers=t.fetchLinkedResources),"decompress"in t&&(t.gltf.decompressMeshes=t.decompress),"decompress"in t.gltf&&(t.gltf.decompressMeshes=t.gltf.decompress),"postProcess"in t&&(t.gltf.postProcess=t.postProcess)}var La=0,Na=1;function Ma(t,e,n){t.rotateYtoZ=!0;var r=t.byteOffset+t.byteLength-n;if(0===r)throw new Error("glTF byte length must be greater than 0.");return t.gltfArrayBuffer=Object(si.b)(e,n,r),t.gltfByteOffset=0,t.gltfByteLength=r,n%4==0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}function za(t,e,n,r){return Ua.apply(this,arguments)}function Ua(){return(Ua=Object(An.a)(Sn.a.mark((function t(e,n,r,i){var a,o,s;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r["3d-tiles"]||{},Ba(e,n,r),!a.loadGLTF){t.next=16;break}if(o=i.parse,s=i.fetch,!e.gltfUrl){t.next=9;break}return t.next=7,s(e.gltfUrl,r);case 7:e.gltfArrayBuffer=t.sent,e.gltfByteOffset=0;case 9:if(!e.gltfArrayBuffer){t.next=16;break}return t.next=12,o(e.gltfArrayBuffer,Ca,r,i);case 12:e.gltf=t.sent,delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ba(t,e,n){switch(e){case La:var r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),i=(new TextDecoder).decode(r);t.gltfUrl=i.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case Na:break;default:throw new Error("b3dm: Illegal glTF format field")}}function Fa(t,e,n,r,i){return Va.apply(this,arguments)}function Va(){return(Va=Object(An.a)(Sn.a.mark((function t(e,n,r,i,a){var o,s;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ga(e,n,r,i,a),t.next=3,za(e,Na,i,a);case 3:return o=e.gltf||{},(s=o.extensions)&&s.CESIUM_RTC&&(e.rtcCenter=s.CESIUM_RTC.center),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ga(t,e,n,r,i){n=Ma(t,e,n=Dr(t,e,n=Rr(t,e,n=Cr(t,e,n))));var a=new gr(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=a.getGlobalProperty("RTC_CENTER",fr.FLOAT,3),n}var Ha=n("T27a"),qa=n("PcVa"),Za=n("kh/P"),Wa=n("FlnL");function Ya(t,e,n,r,i){return Xa.apply(this,arguments)}function Xa(){return(Xa=Object(An.a)(Sn.a.mark((function t(e,n,r,i,a){return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ja(e,n,r,i,a),t.next=3,za(e,e.gltfFormat,i,a);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ja(t,e,n,r,i){if(n=Cr(t,e,n),1!==t.version)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=Rr(t,e,n);var a=new DataView(e);if(t.gltfFormat=a.getUint32(n,!0),n=Ma(t,e,n=Dr(t,e,n+=4)),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new gr(t.featureTableJson,t.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",fr.FLOAT,3);new Ir(t.batchTableJson,t.batchTableBinary,s);return function(t,e,n,r){for(var i=[new Array(r),t._batchTable][0],a=new dr.a,o=(new dr.a,new dr.a,new dr.a,new Ha.a),s=new qa.a,c=new dr.a,u={},l=new Za.a,h=[],p=[],f=new dr.a,d=new dr.a,v=0;v<r;v++){var y=void 0;if(e.hasProperty("POSITION"))y=e.getProperty("POSITION",fr.FLOAT,3,v,a);else if(e.hasProperty("POSITION_QUANTIZED")){y=e.getProperty("POSITION_QUANTIZED",fr.UNSIGNED_SHORT,3,v,a);var b=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",fr.FLOAT,3,f);if(!b)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var g=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",fr.FLOAT,3,d);if(!g)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var m=0;m<3;m++)y[m]=y[m]/65535*g[m]+b[m]}if(!y)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");a.copy(y),u.translation=a,t.normalUp=e.getProperty("NORMAL_UP",fr.FLOAT,3,v,h),t.normalRight=e.getProperty("NORMAL_RIGHT",fr.FLOAT,3,v,p);if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",fr.UNSIGNED_SHORT,2,h),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",fr.UNSIGNED_SHORT,2,p),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(Wa.a.WGS84.eastNorthUpToFixedFrame(a,l),l.getRotationMatrix3(o)):o.identity()}!1,s.fromMatrix3(o),u.rotation=s,c.set(1,1,1);var _=e.getProperty("SCALE",fr.FLOAT,1,v);Number.isFinite(_)&&c.multiplyByScalar(_);var O=e.getProperty("SCALE_NON_UNIFORM",fr.FLOAT,3,v,h);O&&c.scale(O),u.scale=c;var j=e.getProperty("BATCH_ID",fr.UNSIGNED_SHORT,1,v);void 0===j&&(j=v);var w=(new Za.a).fromQuaternion(u.rotation);l.identity(),l.translate(u.translation),l.multiplyRight(w),l.scale(u.scale);var E=l.clone();i[v]={modelMatrix:E,batchId:j}}t.instances=i}(t,o,0,s),n}function Ka(t,e,n,r,i,a){return Qa.apply(this,arguments)}function Qa(){return(Qa=Object(An.a)(Sn.a.mark((function t(e,n,r,i,a,o){var s,c;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=Cr(e,n,r),s=new DataView(n),e.tilesLength=s.getUint32(r,!0),r+=4,e.tiles=[];case 5:if(!(e.tiles.length<e.tilesLength&&e.byteLength-r>12)){t.next=13;break}return c={},e.tiles.push(c),t.next=10,o(n,r,i,a,c);case 10:r=t.sent,t.next=5;break;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $a(t){return to.apply(this,arguments)}function to(){return(to=Object(An.a)(Sn.a.mark((function t(e){var n,r,i,a,o=arguments;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=o.length>1&&void 0!==o[1]?o[1]:0,r=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,(a=o.length>4&&void 0!==o[4]?o[4]:{}).byteOffset=n,a.type=Vn(e,n),t.t0=a.type,t.next=t.t0===Un.COMPOSITE?9:t.t0===Un.BATCHED_3D_MODEL?12:t.t0===Un.INSTANCED_3D_MODEL?15:t.t0===Un.POINT_CLOUD?18:21;break;case 9:return t.next=11,Ka(a,e,n,r,i,$a);case 11:return t.abrupt("return",t.sent);case 12:return t.next=14,Fa(a,e,n,r,i);case 14:return t.abrupt("return",t.sent);case 15:return t.next=17,Ya(a,e,n,r,i);case 17:return t.abrupt("return",t.sent);case 18:return t.next=20,Yr(a,e,n,r,i);case 20:return t.abrupt("return",t.sent);case 21:throw new Error("3DTileLoader: unknown type ".concat(a.type));case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function eo(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return no(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return no(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function no(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ro(t,e){if(t.content){var n=t.content.uri||t.content.url;t.contentUrl="".concat(e.basePath,"/").concat(n)}return t.id=t.contentUrl,t.lodMetricType=zn,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=function(t){if(!t.contentUrl)return Dn;var e=t.contentUrl.split(".").pop();switch(e){case"pnts":return Nn;case"i3dm":case"b3dm":return Ln;default:return e}}(t),t.refine=function(t){switch(t){case"REPLACE":case"replace":return Rn;case"ADD":case"add":return Cn;default:return t}}(t.refine),t}function io(t){var e=t.basePath,n=ro(t.root,t),r=[];for(r.push(n);r.length>0;){var i,a=eo(r.pop().children||[]);try{for(a.s();!(i=a.n()).done;){var o=i.value;ro(o,{basePath:e}),r.push(o)}}catch(s){a.e(s)}finally{a.f()}}return n}function ao(t){return In.a.dirname(t.url)}function oo(t,e,n){return so.apply(this,arguments)}function so(){return(so=Object(An.a)(Sn.a.mark((function t(e,n,r){var i;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).content=i.content||{},0,t.next=5,$a(e,0,n,r,i.content);case 5:return t.abrupt("return",i.content);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function co(t,e,n){return uo.apply(this,arguments)}function uo(){return(uo=Object(An.a)(Sn.a.mark((function t(e,n,r){var i;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=JSON.parse((new TextDecoder).decode(e))).loader=n.loader||ho,i.url=r.url,i.basePath=ao(i),i.root=io(i),i.type=Mn,i.lodMetricType=zn,i.lodMetricValue=i.root.lodMetricValue,t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function lo(){return(lo=Object(An.a)(Sn.a.mark((function t(e,n,r,i){var a;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n["3d-tiles"]||{},!("auto"===a.isTileset?r.url&&-1!==r.url.indexOf(".json"):a.isTileset)){t.next=8;break}return t.next=5,co(e,n,r);case 5:e=t.sent,t.next=11;break;case 8:return t.next=10,oo(e,n,r);case 10:e=t.sent;case 11:return t.abrupt("return",e);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ho={id:"3d-tiles",name:"3D Tiles",version:"2.3.0",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:function(t,e,n,r){return lo.apply(this,arguments)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",tile:null,tileset:null}}},po=ho,fo=n("OauZ");function vo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vo(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function bo(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return go(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return go(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function go(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var mo="https://api.cesium.com/v1/assets";function _o(t,e){return Oo.apply(this,arguments)}function Oo(){return(Oo=Object(An.a)(Sn.a.mark((function t(e,n){var r,i,a,o,s,c,u;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=6;break}return t.next=3,jo(e);case 3:r=t.sent,i=bo(r.items);try{for(i.s();!(a=i.n()).done;)"3DTILES"===(o=a.value).type&&(n=o.id)}catch(l){i.e(l)}finally{i.f()}case 6:return t.next=8,Eo(e,n);case 8:return s=t.sent,c=s.type,u=s.url,Object(Bn.a)("3DTILES"===c&&u),s.headers={Authorization:"Bearer ".concat(s.accessToken)},t.abrupt("return",s);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function jo(t){return wo.apply(this,arguments)}function wo(){return(wo=Object(An.a)(Sn.a.mark((function t(e){var n,r;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object(Bn.a)(e),mo,n={Authorization:"Bearer ".concat(e)},t.next=5,Object(fo.a)("https://api.cesium.com/v1/assets",{headers:n,throws:!0});case 5:return r=t.sent,t.next=8,r.json();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Eo(t,e){return To.apply(this,arguments)}function To(){return(To=Object(An.a)(Sn.a.mark((function t(e,n){var r,i,a,o,s;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object(Bn.a)(e,n),r={Authorization:"Bearer ".concat(e)},i="".concat(mo,"/").concat(n),t.next=5,Object(fo.a)("".concat(i),{headers:r,throws:!0});case 5:return a=t.sent,t.next=8,a.json();case 8:return o=t.sent,t.next=11,Object(fo.a)("".concat(i,"/endpoint"),{headers:r,throws:!0});case 11:return a=t.sent,t.next=14,a.json();case 14:return s=t.sent,o=yo(yo({},o),s),t.abrupt("return",o);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ko(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ko(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ko(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Po(){return(Po=Object(An.a)(Sn.a.mark((function t(e){var n,r,i,a,o=arguments;return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(n=o.length>1&&void 0!==o[1]?o[1]:{})["cesium-ion"]||{},r=n.accessToken,i=n.assetId,Number.isFinite(i)||(a=e.match(/\/([0-9]+)\/tileset.json/),i=a&&a[1]),t.abrupt("return",_o(r,i));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var So,Ao=xo(xo({},po),{},{id:"cesium-ion",name:"Cesium Ion",preload:function(t){return Po.apply(this,arguments)},parse:(So=Object(An.a)(Sn.a.mark((function t(e,n,r,i){return Sn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n["3d-tiles"]=n["cesium-ion"],n.loader=Ao,t.abrupt("return",po.parse(e,n,r));case 3:case"end":return t.stop()}}),t)}))),function(t,e,n,r){return So.apply(this,arguments)}),options:{"cesium-ion":xo(xo({},po.options["3d-tiles"]),{},{accessToken:null})}}),Io=Ao;function Co(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ro(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Co(Object(n),!0).forEach((function(e){Object(h.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Co(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Do={latitude:40,longitude:-75,pitch:45,maxPitch:60,bearing:0,minZoom:2,maxZoom:30,zoom:17};function Lo(t){var e=t.mapStyle,n=void 0===e?"https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json":e,r=t.updateAttributions,i=Object(c.useState)(Do),a=i[0],o=i[1],s=new xn.a({id:"tile-3d-layer",pointSize:2,data:"https://assets.cesium.com/43978/tileset.json",loader:Io,loadOptions:{"cesium-ion":{accessToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlYWMxMzcyYy0zZjJkLTQwODctODNlNi01MDRkZmMzMjIxOWIiLCJpZCI6OTYyMCwic2NvcGVzIjpbImFzbCIsImFzciIsImdjIl0sImlhdCI6MTU2Mjg2NjI3M30.1FNiClUyk00YH_nWfSGpiQAjR5V2OvREDq1PJ5QMjWQ"}},onTilesetLoad:function(t){var e=t.cartographicCenter,n=t.zoom;o(Ro(Ro({},Do),{},{longitude:e[0],latitude:e[1],zoom:n})),r&&r(t.credits&&t.credits.attributions)}});return u.a.createElement(kn.a,{layers:[s],initialViewState:a,controller:!0},u.a.createElement(yt,{reuseMaps:!0,mapStyle:n,preventStyleDiffing:!0}))}var No=n("CtqP"),Mo=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this)._updateAttributions=function(t){e.props.onStateChange({attributions:t})},e}return Object(s.a)(e,t),e.renderInfo=function(t){if(!t.attributions)return null;var e=t.attributions;return u.a.createElement("div",{style:{marginTop:"0.5cm"}},u.a.createElement("div",{style:{textAlign:"center",borderStyle:"groove"}},Boolean(e.length)&&u.a.createElement("b",null,"Tileset Credentials"),e.map((function(t){return u.a.createElement("div",{key:t.html,dangerouslySetInnerHTML:{__html:t.html}})}))))},e.prototype.render=function(){return u.a.createElement(Lo,Object.assign({},this.props,{updateAttributions:this._updateAttributions}))},e}(c.Component);Mo.title="City of Melbourne 3D Point Cloud",Mo.code=l.b+"/examples/website/3d-tiles",Mo.parameters={},Mo.mapStyle=l.c.DARK;e.default=Object(No.a)(Mo)},evtk:function(t,e,n){"use strict";(function(t){var r=n("q1tI");function i(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof self?self:t;var r,i,a="undefined"!=typeof document&&document.attachEvent;if(!a){var o=(i=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(t){return n.setTimeout(t,20)},function(t){return i(t)}),s=(r=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.clearTimeout,function(t){return r(t)}),c=function(t){var e=t.__resizeTriggers__,n=e.firstElementChild,r=e.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},u=function(t){if(!(t.target.className.indexOf("contract-trigger")<0&&t.target.className.indexOf("expand-trigger")<0)){var e=this;c(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=o((function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach((function(n){n.call(e,t)})))}))}},l=!1,h="",p="animationstart",f="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),v=document.createElement("fakeelement");if(void 0!==v.style.animationName&&(l=!0),!1===l)for(var y=0;y<f.length;y++)if(void 0!==v.style[f[y]+"AnimationName"]){h="-"+f[y].toLowerCase()+"-",p=d[y],l=!0;break}var b="resizeanim",g="@"+h+"keyframes "+b+" { from { opacity: 0; } to { opacity: 0; } } ",m=h+"animation: 1ms "+b+"; "}return{addResizeListener:function(t,r){if(a)t.attachEvent("onresize",r);else{if(!t.__resizeTriggers__){var i=t.ownerDocument,o=n.getComputedStyle(t);o&&"static"==o.position&&(t.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var n=(g||"")+".resize-triggers { "+(m||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=t.head||t.getElementsByTagName("head")[0],i=t.createElement("style");i.id="detectElementResize",i.type="text/css",null!=e&&i.setAttribute("nonce",e),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(t.createTextNode(n)),r.appendChild(i)}}(i),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=i.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),c(t),t.addEventListener("scroll",u,!0),p&&(t.__resizeTriggers__.__animationListener__=function(e){e.animationName==b&&c(t)},t.__resizeTriggers__.addEventListener(p,t.__resizeTriggers__.__animationListener__))}t.__resizeListeners__.push(r)}},removeResizeListener:function(t,e){if(a)t.detachEvent("onresize",e);else if(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),!t.__resizeListeners__.length){t.removeEventListener("scroll",u,!0),t.__resizeTriggers__.__animationListener__&&(t.__resizeTriggers__.removeEventListener(p,t.__resizeTriggers__.__animationListener__),t.__resizeTriggers__.__animationListener__=null);try{t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)}catch(n){}}}}}var a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},u=function(t){function e(){var t,n,r;a(this,e);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=r=c(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var t=r.props,e=t.disableHeight,n=t.disableWidth,i=t.onResize;if(r._parentNode){var a=r._parentNode.offsetHeight||0,o=r._parentNode.offsetWidth||0,s=window.getComputedStyle(r._parentNode)||{},c=parseInt(s.paddingLeft,10)||0,u=parseInt(s.paddingRight,10)||0,l=parseInt(s.paddingTop,10)||0,h=parseInt(s.paddingBottom,10)||0,p=a-l-h,f=o-c-u;(!e&&r.state.height!==p||!n&&r.state.width!==f)&&(r.setState({height:a-l-h,width:o-c-u}),i({height:a,width:o}))}},r._setRef=function(t){r._autoSizer=t},c(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"componentDidMount",value:function(){var t=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=i(t),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var t=this.props,e=t.children,n=t.className,i=t.disableHeight,a=t.disableWidth,o=t.style,c=this.state,u=c.height,l=c.width,h={overflow:"visible"},p={},f=!1;return i||(0===u&&(f=!0),h.height=0,p.height=u),a||(0===l&&(f=!0),h.width=0,p.width=l),Object(r.createElement)("div",{className:n,ref:this._setRef,style:s({},h,o)},!f&&e(p))}}]),e}(r.PureComponent);u.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}},e.a=u}).call(this,n("yLpj"))},oJR1:function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var r="undefined"!=typeof window?window:t,i=(void 0!==t||window,"undefined"!=typeof document?document:{})}).call(this,n("yLpj"))},q8n8:function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var r="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i="undefined"!=typeof window?window:t,a=(void 0!==t||window,"undefined"!=typeof document&&document,!1);try{var o={get passive(){return a=!0,!0}};i.addEventListener("test",o,o),i.removeEventListener("test",o,o)}catch(s){}}).call(this,n("yLpj"))}}]);